"use strict";(self.webpackChunk_aarpaardev_stix_visualizer=self.webpackChunk_aarpaardev_stix_visualizer||[]).push([[706],{"./node_modules/react-force-graph-2d/dist/react-force-graph-2d.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ForceGraph2D});var react=__webpack_require__("./node_modules/react/index.js");function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function react_kapsule_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function react_kapsule_slicedToArray(r,e){return function react_kapsule_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function react_kapsule_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l);else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||react_kapsule_unsupportedIterableToArray(r,e)||function react_kapsule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function react_kapsule_toConsumableArray(r){return function react_kapsule_arrayWithoutHoles(r){if(Array.isArray(r))return react_kapsule_arrayLikeToArray(r)}(r)||function react_kapsule_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||react_kapsule_unsupportedIterableToArray(r)||function react_kapsule_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function react_kapsule_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return react_kapsule_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?react_kapsule_arrayLikeToArray(r,a):void 0}}function useEffectOnce(effect){var useEffectFn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:react.useEffect,destroyFunc=(0,react.useRef)(),effectCalled=(0,react.useRef)(!1),renderAfterCalled=(0,react.useRef)(!1),_useState2=react_kapsule_slicedToArray((0,react.useState)(0),2);_useState2[0];var setVal=_useState2[1];effectCalled.current&&(renderAfterCalled.current=!0),useEffectFn((function(){return effectCalled.current||(destroyFunc.current=effect(),effectCalled.current=!0),setVal((function(val){return val+1})),function(){renderAfterCalled.current&&destroyFunc.current&&destroyFunc.current()}}),[])}function none(){}function selector(selector){return null==selector?none:function(){return this.querySelector(selector)}}function empty(){return[]}function selectorAll(selector){return null==selector?empty:function(){return this.querySelectorAll(selector)}}function arrayAll(select){return function(){return function array(x){return null==x?[]:Array.isArray(x)?x:Array.from(x)}(select.apply(this,arguments))}}function matcher(selector){return function(){return this.matches(selector)}}function childMatcher(selector){return function(node){return node.matches(selector)}}var find=Array.prototype.find;function childFirst(){return this.firstElementChild}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function sparse(update){return new Array(update.length)}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue=new Map,groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=key.call(node,node.__data__,i,group)+"",nodeByKeyValue.has(keyValue)?exit[i]=node:nodeByKeyValue.set(keyValue,node));for(i=0;i<dataLength;++i)keyValue=key.call(parent,data[i],i,data)+"",(node=nodeByKeyValue.get(keyValue))?(update[i]=node,node.__data__=data[i],nodeByKeyValue.delete(keyValue)):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue.get(keyValues[i])===node&&(exit[i]=node)}function datum(node){return node.__data__}function arraylike(data){return"object"==typeof data&&"length"in data?data:Array.from(data)}function ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,value){return function(){this.setAttribute(name,value)}}function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}function src_window(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView}function styleRemove(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}}function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}function styleValue(node,name){return node.style.getPropertyValue(name)||src_window(node).getComputedStyle(node,null).getPropertyValue(name)}function propertyRemove(name){return function(){delete this[name]}}function propertyConstant(name,value){return function(){this[name]=value}}function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function classedTrue(names){return function(){classedAdd(this,names)}}function classedFalse(names){return function(){classedRemove(this,names)}}function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}function textRemove(){this.textContent=""}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}function htmlRemove(){this.innerHTML=""}function htmlConstant(value){return function(){this.innerHTML=value}}function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}}function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}function creator(name){var fullname=namespace(name);return(fullname.local?creatorFixed:creatorInherit)(fullname)}function constantNull(){return null}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function selection_cloneShallow(){var clone=this.cloneNode(!1),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function selection_cloneDeep(){var clone=this.cloneNode(!0),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.options);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,options){return function(){var o,on=this.__on,listener=function contextListener(listener){return function(event){listener.call(this,event,this.__data__)}}(value);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=listener,o.options=options),void(o.value=value);this.addEventListener(typename.type,listener,options),o={type:typename.type,name:typename.name,value,listener,options},on?on.push(o):this.__on=[o]}}function dispatchEvent(node,type,params){var window=src_window(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}}function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var root=[null];function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}Selection.prototype=selection.prototype={constructor:Selection,select:function selection_select(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)},selectAll:function selectAll(select){select="function"==typeof select?arrayAll(select):selectorAll(select);for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)},selectChild:function selectChild(match){return this.select(null==match?childFirst:function childFind(match){return function(){return find.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},selectChildren:function selectChildren(match){return this.selectAll(null==match?children:function childrenFilter(match){return function(){return filter.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},filter:function selection_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)},data:function data(value,key){if(!arguments.length)return Array.from(this,datum);var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=function src_constant(x){return function(){return x}}(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=arraylike(value.call(parent,parent&&parent.__data__,j,parents)),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return(update=new Selection(update,parents))._enter=enter,update._exit=exit,update},enter:function enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)},exit:function exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)},join:function join(onenter,onupdate,onexit){var enter=this.enter(),update=this,exit=this.exit();return"function"==typeof onenter?(enter=onenter(enter))&&(enter=enter.selection()):enter=enter.append(onenter+""),null!=onupdate&&(update=onupdate(update))&&(update=update.selection()),null==onexit?exit.remove():onexit(exit),enter&&update?enter.merge(update).order():update},merge:function merge(context){for(var selection=context.selection?context.selection():context,groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)},selection:function selection_selection(){return this},order:function order(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&4^node.compareDocumentPosition(next)&&next.parentNode.insertBefore(node,next),next=node);return this},sort:function sort(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()},call:function call(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},nodes:function nodes(){return Array.from(this)},node:function node(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},size:function size(){let size=0;for(const node of this)++size;return size},empty:function selection_empty(){return!this.node()},each:function each(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},attr:function attr(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?attrRemoveNS:attrRemove:"function"==typeof value?fullname.local?attrFunctionNS:attrFunction:fullname.local?attrConstantNS:attrConstant)(fullname,value))},style:function style(name,value,priority){return arguments.length>1?this.each((null==value?styleRemove:"function"==typeof value?styleFunction:styleConstant)(name,value,null==priority?"":priority)):styleValue(this.node(),name)},property:function property(name,value){return arguments.length>1?this.each((null==value?propertyRemove:"function"==typeof value?propertyFunction:propertyConstant)(name,value)):this.node()[name]},classed:function classed(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?classedFunction:value?classedTrue:classedFalse)(names,value))},text:function selection_text(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?textFunction:textConstant)(value)):this.node().textContent},html:function html(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?htmlFunction:htmlConstant)(value)):this.node().innerHTML},raise:function selection_raise(){return this.each(raise)},lower:function selection_lower(){return this.each(lower)},append:function append(name){var create="function"==typeof name?name:creator(name);return this.select((function(){return this.appendChild(create.apply(this,arguments))}))},insert:function insert(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select((function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)}))},remove:function selection_remove(){return this.each(remove)},clone:function clone(deep){return this.select(deep?selection_cloneDeep:selection_cloneShallow)},datum:function selection_datum(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function on(typename,value,options){var i,t,typenames=function parseTypenames(typenames){return typenames.trim().split(/^|\s+/).map((function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name}}))}(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,i=0;i<n;++i)this.each(on(typenames[i],value,options));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},dispatch:function dispatch(type,params){return this.each(("function"==typeof params?dispatchFunction:dispatchConstant)(type,params))},[Symbol.iterator]:function*iterator(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&(yield node)}};const src_selection=selection;function src_select(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)}var noop={value:()=>{}};function dispatch_dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _||/[\s.]/.test(t))throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name,value:callback}),type}Dispatch.prototype=dispatch_dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=function dispatch_parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map((function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name}}))}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};const src_dispatch=dispatch_dispatch,nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation(event){event.stopImmediatePropagation()}function noevent(event){event.preventDefault(),event.stopImmediatePropagation()}function nodrag(view){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",noevent,nonpassivecapture);"onselectstart"in root?selection.on("selectstart.drag",noevent,nonpassivecapture):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")}function yesdrag(view,noclick){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,nonpassivecapture),setTimeout((function(){selection.on("click.drag",null)}),0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function cosh(x){return((x=Math.exp(x))+1/x)/2}const src_zoom=function zoomRho(rho,rho2,rho4){function zoom(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+rho4*d2)/(2*w0*rho2*d1),b1=(w1*w1-w0*w0-rho4*d2)/(2*w1*rho2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(rho2*d1)*(coshr0*function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}(rho*s+r0)-function sinh(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S*rho/Math.SQRT2,i}return zoom.rho=function(_){var _1=Math.max(.001,+_),_2=_1*_1;return zoomRho(_1,_2,_2*_2)},zoom}(Math.SQRT2,2,4);function pointer(event,node){if(event=function sourceEvent(event){let sourceEvent;for(;sourceEvent=event.sourceEvent;)event=sourceEvent;return event}(event),void 0===node&&(node=event.currentTarget),node){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,[(point=point.matrixTransform(node.getScreenCTM().inverse())).x,point.y]}if(node.getBoundingClientRect){var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}}return[event.pageX,event.pageY]}var taskHead,taskTail,timer_frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function wake(){clockNow=(clockLast=clock.now())+clockSkew,timer_frame=timeout=0;try{!function timerFlush(){now(),++timer_frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(void 0,e),t=t._next;--timer_frame}()}finally{timer_frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){timer_frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),timer_frame=1,setFrame(wake)))}function src_timeout(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart((elapsed=>{t.stop(),callback(elapsed+delay)}),delay,time),t}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=src_dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};!function create(node,id,self){var tween,schedules=node.__transition;function schedule(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)}function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if((o=schedules[i]).name===self.name){if(o.state===STARTED)return src_timeout(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),o.on.call("cancel",node,node.__data__,o.index,o.group),delete schedules[i])}if(src_timeout((function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))})),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(node,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){for(var i in self.state=ENDED,self.timer.stop(),delete schedules[id],schedules)return;delete node.__transition}schedules[id]=self,self.timer=timer(schedule,0,self.time)}(node,id,{name,index,group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})}function init(node,id){var schedule=schedule_get(node,id);if(schedule.state>CREATED)throw new Error("too late; already scheduled");return schedule}function schedule_set(node,id){var schedule=schedule_get(node,id);if(schedule.state>STARTED)throw new Error("too late; already running");return schedule}function schedule_get(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}function interrupt(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){for(i in name=null==name?null:name+"",schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),schedule.on.call(active?"interrupt":"cancel",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}}function number(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}}var svgNode,degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX,scaleY}}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform((function parseCss(value){const m=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(value+"");return m.isIdentity?identity:decompose(m.a,m.b,m.c,m.d,m.e,m.f)}),"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform((function parseSvg(value){return null==value?identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?decompose((value=value.matrix).a,value.b,value.c,value.d,value.e,value.f):identity)}),", ",")",")");function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0)for(var i=0,n=(tween1=tween0=tween).length;i<n;++i)if(tween1[i].name===name){(tween1=tween1.slice()).splice(i,1);break}schedule.tween=tween1}}function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name,value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}}function tweenValue(transition,name,value){var id=transition._id;return transition.each((function(){var schedule=schedule_set(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)})),function(node){return schedule_get(node,id).value[name]}}function src_define(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor}function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}var brighter=1/.7,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatRgb(){return this.rgb().formatRgb()}function color(format){var m,l;return format=(format+"").trim().toLowerCase(),(m=reHex.exec(format))?(l=m[1].length,m=parseInt(m[1],16),6===l?rgbn(m):3===l?new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):8===l?rgba(m>>24&255,m>>16&255,m>>8&255,(255&m)/255):4===l?rgba(m>>12&15|m>>8&240,m>>8&15|m>>4&240,m>>4&15|240&m,((15&m)<<4|15&m)/255):null):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function color_rgb(r,g,b,opacity){return 1===arguments.length?function rgbConvert(o){return o instanceof Color||(o=color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatRgb(){const a=clampa(this.opacity);return`${1===a?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${1===a?")":`, ${a})`}`}function clampa(opacity){return isNaN(opacity)?1:Math.max(0,Math.min(1,opacity))}function clampi(value){return Math.max(0,Math.min(255,Math.round(value)||0))}function hex(value){return((value=clampi(value))<16?"0":"")+value.toString(16)}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function clamph(value){return(value=(value||0)%360)<0?value+360:value}function clampt(value){return Math.max(0,Math.min(1,value||0))}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}src_define(Color,color,{copy(channels){return Object.assign(new this.constructor,this,channels)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:function color_formatHex8(){return this.rgb().formatHex8()},formatHsl:function color_formatHsl(){return hslConvert(this).formatHsl()},formatRgb:color_formatRgb,toString:color_formatRgb}),src_define(Rgb,color_rgb,extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),src_define(Hsl,(function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)}),extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const a=clampa(this.opacity);return`${1===a?"hsl(":"hsla("}${clamph(this.h)}, ${100*clampt(this.s)}%, ${100*clampt(this.l)}%${1===a?")":`, ${a})`}`}}));const d3_interpolate_src_constant=x=>()=>x;function linear(a,d){return function(t){return a+t*d}}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):d3_interpolate_src_constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):d3_interpolate_src_constant(isNaN(a)?b:a)}const rgb=function rgbGamma(y){var color=gamma(y);function rgb(start,end){var r=color((start=color_rgb(start)).r,(end=color_rgb(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(spline){return function(colors){var i,color,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color=color_rgb(colors[i]),r[i]=color.r||0,g[i]=color.g||0,b[i]=color.b||0;return r=spline(r),g=spline(g),b=spline(b),color.opacity=1,function(t){return color.r=r(t),color.g=g(t),color.b=b(t),color+""}}}rgbSpline((function src_basis(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}})),rgbSpline((function basisClosed(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}}));var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function string(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i,x:number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function one(b){return function(t){return b(t)+""}}(q[0].x):function zero(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}function interpolate(a,b){var c;return("number"==typeof b?number:b instanceof color?rgb:(c=color(b))?(b=c,rgb):string)(a,b)}function attr_attrRemove(name){return function(){this.removeAttribute(name)}}function attr_attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attr_attrConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttribute(name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrConstantNS(fullname,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttributeNS(fullname.space,fullname.local);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttribute(name))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttribute(name)}}function attr_attrFunctionNS(fullname,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttributeNS(fullname.space,fullname.local))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttributeNS(fullname.space,fullname.local)}}function attrTweenNS(fullname,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolateNS(fullname,i){return function(t){this.setAttributeNS(fullname.space,fullname.local,i.call(this,t))}}(fullname,i)),t0}return tween._value=value,tween}function attrTween(name,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolate(name,i){return function(t){this.setAttribute(name,i.call(this,t))}}(name,i)),t0}return tween._value=value,tween}function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}}function durationFunction(id,value){return function(){schedule_set(this,id).duration=+value.apply(this,arguments)}}function durationConstant(id,value){return value=+value,function(){schedule_set(this,id).duration=value}}var selection_Selection=src_selection.prototype.constructor;function style_styleRemove(name){return function(){this.style.removeProperty(name)}}var id=0;function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function newId(){return++id}var selection_prototype=src_selection.prototype;Transition.prototype=function transition_transition(name){return src_selection().transition(name)}.prototype={constructor:Transition,select:function transition_select(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,schedule_get(node,id)));return new Transition(subgroups,this._parents,name,id)},selectAll:function transition_selectAll(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=schedule_get(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:function transition_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},merge:function transition_merge(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},selection:function transition_selection(){return new selection_Selection(this._groups,this._parents)},transition:function transition(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=schedule_get(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:function transition_on(name,listener){var id=this._id;return arguments.length<2?schedule_get(this.node(),id).on.on(name):this.each(function onFunction(id,name,listener){var on0,on1,sit=function start(name){return(name+"").trim().split(/^|\s+/).every((function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t}))}(name)?init:schedule_set;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}(id,name,listener))},attr:function transition_attr(name,value){var fullname=namespace(name),i="transform"===fullname?interpolateTransformSvg:interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?attr_attrFunctionNS:attr_attrFunction)(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?attr_attrRemoveNS:attr_attrRemove)(fullname):(fullname.local?attr_attrConstantNS:attr_attrConstant)(fullname,i,value))},attrTween:function transition_attrTween(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=namespace(name);return this.tween(key,(fullname.local?attrTweenNS:attrTween)(fullname,value))},style:function transition_style(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:interpolate;return null==value?this.styleTween(name,function styleNull(name,interpolate){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),string1=(this.style.removeProperty(name),styleValue(this,name));return string0===string1?null:string0===string00&&string1===string10?interpolate0:interpolate0=interpolate(string00=string0,string10=string1)}}(name,i)).on("end.style."+name,style_styleRemove(name)):"function"==typeof value?this.styleTween(name,function style_styleFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),value1=value(this),string1=value1+"";return null==value1&&(this.style.removeProperty(name),string1=value1=styleValue(this,name)),string0===string1?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1))}}(name,i,tweenValue(this,"style."+name,value))).each(function styleMaybeRemove(id,name){var on0,on1,listener0,remove,key="style."+name,event="end."+key;return function(){var schedule=schedule_set(this,id),on=schedule.on,listener=null==schedule.value[key]?remove||(remove=style_styleRemove(name)):void 0;on===on0&&listener0===listener||(on1=(on0=on).copy()).on(event,listener0=listener),schedule.on=on1}}(this._id,name)):this.styleTween(name,function style_styleConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=styleValue(this,name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}(name,i,value),priority).on("end.style."+name,null)},styleTween:function transition_styleTween(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function styleTween(name,value,priority){var t,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t=(i0=i)&&function styleInterpolate(name,i,priority){return function(t){this.style.setProperty(name,i.call(this,t),priority)}}(name,i,priority)),t}return tween._value=value,tween}(name,value,null==priority?"":priority))},text:function transition_text(value){return this.tween("text","function"==typeof value?function text_textFunction(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}(tweenValue(this,"text",value)):function text_textConstant(value){return function(){this.textContent=value}}(null==value?"":value+""))},textTween:function transition_textTween(value){var key="text";if(arguments.length<1)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function textTween(value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function textInterpolate(i){return function(t){this.textContent=i.call(this,t)}}(i)),t0}return tween._value=value,tween}(value))},remove:function transition_remove(){return this.on("end.remove",function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}(this._id))},tween:function tween(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=schedule_get(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?tweenRemove:tweenFunction)(id,name,value))},delay:function delay(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?delayFunction:delayConstant)(id,value)):schedule_get(this.node(),id).delay},duration:function duration(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?durationFunction:durationConstant)(id,value)):schedule_get(this.node(),id).duration},ease:function ease(value){var id=this._id;return arguments.length?this.each(function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){schedule_set(this,id).ease=value}}(id,value)):schedule_get(this.node(),id).ease},easeVarying:function transition_easeVarying(value){if("function"!=typeof value)throw new Error;return this.each(function easeVarying(id,value){return function(){var v=value.apply(this,arguments);if("function"!=typeof v)throw new Error;schedule_set(this,id).ease=v}}(this._id,value))},end:function end(){var on0,on1,that=this,id=that._id,size=that.size();return new Promise((function(resolve,reject){var cancel={value:reject},end={value:function(){0==--size&&resolve()}};that.each((function(){var schedule=schedule_set(this,id),on=schedule.on;on!==on0&&((on1=(on0=on).copy())._.cancel.push(cancel),on1._.interrupt.push(cancel),on1._.end.push(end)),schedule.on=on1})),0===size&&resolve()}))},[Symbol.iterator]:selection_prototype[Symbol.iterator]};var defaultTiming={time:null,delay:0,duration:250,ease:function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))throw new Error(`transition ${id} not found`);return timing}src_selection.prototype.interrupt=function selection_interrupt(name){return this.each((function(){interrupt(this,name)}))},src_selection.prototype.transition=function selection_transition(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};const d3_zoom_src_constant=x=>()=>x;function ZoomEvent(type,{sourceEvent,target,transform,dispatch}){Object.defineProperties(this,{type:{value:type,enumerable:!0,configurable:!0},sourceEvent:{value:sourceEvent,enumerable:!0,configurable:!0},target:{value:target,enumerable:!0,configurable:!0},transform:{value:transform,enumerable:!0,configurable:!0},_:{value:dispatch}})}function Transform(k,x,y){this.k=k,this.x=x,this.y=y}Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var transform_identity=new Transform(1,0,0);function transform(node){for(;!node.__zoom;)if(!(node=node.parentNode))return transform_identity;return node.__zoom}function noevent_nopropagation(event){event.stopImmediatePropagation()}function src_noevent(event){event.preventDefault(),event.stopImmediatePropagation()}function defaultFilter(event){return!(event.ctrlKey&&"wheel"!==event.type||event.button)}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||transform_identity}function defaultWheelDelta(event){return-event.deltaY*(1===event.deltaMode?.05:event.deltaMode?1:.002)*(event.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(transform,extent,translateExtent){var dx0=transform.invertX(extent[0][0])-translateExtent[0][0],dx1=transform.invertX(extent[1][0])-translateExtent[1][0],dy0=transform.invertY(extent[0][1])-translateExtent[0][1],dy1=transform.invertY(extent[1][1])-translateExtent[1][1];return transform.translate(dx1>dx0?(dx0+dx1)/2:Math.min(0,dx0)||Math.max(0,dx1),dy1>dy0?(dy0+dy1)/2:Math.min(0,dy0)||Math.max(0,dy1))}function zoom(){var touchstarting,touchfirst,touchending,filter=defaultFilter,extent=defaultExtent,constrain=defaultConstrain,wheelDelta=defaultWheelDelta,touchable=defaultTouchable,scaleExtent=[0,1/0],translateExtent=[[-1/0,-1/0],[1/0,1/0]],duration=250,interpolate=src_zoom,listeners=src_dispatch("start","zoom","end"),touchDelay=500,wheelDelay=150,clickDistance2=0,tapDistance=10;function zoom(selection){selection.property("__zoom",defaultTransform).on("wheel.zoom",wheeled,{passive:!1}).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).filter(touchable).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function scale(transform,k){return(k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],k)))===transform.k?transform:new Transform(k,transform.x,transform.y)}function translate(transform,p0,p1){var x=p0[0]-p1[0]*transform.k,y=p0[1]-p1[1]*transform.k;return x===transform.x&&y===transform.y?transform:new Transform(transform.k,x,y)}function centroid(extent){return[(+extent[0][0]+ +extent[1][0])/2,(+extent[0][1]+ +extent[1][1])/2]}function schedule(transition,transform,point,event){transition.on("start.zoom",(function(){gesture(this,arguments).event(event).start()})).on("interrupt.zoom end.zoom",(function(){gesture(this,arguments).event(event).end()})).tween("zoom",(function(){var args=arguments,g=gesture(this,args).event(event),e=extent.apply(this,args),p=null==point?centroid(e):"function"==typeof point?point.apply(this,args):point,w=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),a=this.__zoom,b="function"==typeof transform?transform.apply(this,args):transform,i=interpolate(a.invert(p).concat(w/a.k),b.invert(p).concat(w/b.k));return function(t){if(1===t)t=b;else{var l=i(t),k=w/l[2];t=new Transform(k,p[0]-l[0]*k,p[1]-l[1]*k)}g.zoom(null,t)}}))}function gesture(that,args,clean){return!clean&&that.__zooming||new Gesture(that,args)}function Gesture(that,args){this.that=that,this.args=args,this.active=0,this.sourceEvent=null,this.extent=extent.apply(that,args),this.taps=0}function wheeled(event,...args){if(filter.apply(this,arguments)){var g=gesture(this,args).event(event),t=this.__zoom,k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],t.k*Math.pow(2,wheelDelta.apply(this,arguments)))),p=pointer(event);if(g.wheel)g.mouse[0][0]===p[0]&&g.mouse[0][1]===p[1]||(g.mouse[1]=t.invert(g.mouse[0]=p)),clearTimeout(g.wheel);else{if(t.k===k)return;g.mouse=[p,t.invert(p)],interrupt(this),g.start()}src_noevent(event),g.wheel=setTimeout((function wheelidled(){g.wheel=null,g.end()}),wheelDelay),g.zoom("mouse",constrain(translate(scale(t,k),g.mouse[0],g.mouse[1]),g.extent,translateExtent))}}function mousedowned(event,...args){if(!touchending&&filter.apply(this,arguments)){var currentTarget=event.currentTarget,g=gesture(this,args,!0).event(event),v=src_select(event.view).on("mousemove.zoom",(function mousemoved(event){if(src_noevent(event),!g.moved){var dx=event.clientX-x0,dy=event.clientY-y0;g.moved=dx*dx+dy*dy>clickDistance2}g.event(event).zoom("mouse",constrain(translate(g.that.__zoom,g.mouse[0]=pointer(event,currentTarget),g.mouse[1]),g.extent,translateExtent))}),!0).on("mouseup.zoom",(function mouseupped(event){v.on("mousemove.zoom mouseup.zoom",null),yesdrag(event.view,g.moved),src_noevent(event),g.event(event).end()}),!0),p=pointer(event,currentTarget),x0=event.clientX,y0=event.clientY;nodrag(event.view),noevent_nopropagation(event),g.mouse=[p,this.__zoom.invert(p)],interrupt(this),g.start()}}function dblclicked(event,...args){if(filter.apply(this,arguments)){var t0=this.__zoom,p0=pointer(event.changedTouches?event.changedTouches[0]:event,this),p1=t0.invert(p0),k1=t0.k*(event.shiftKey?.5:2),t1=constrain(translate(scale(t0,k1),p0,p1),extent.apply(this,args),translateExtent);src_noevent(event),duration>0?src_select(this).transition().duration(duration).call(schedule,t1,p0,event):src_select(this).call(zoom.transform,t1,p0,event)}}function touchstarted(event,...args){if(filter.apply(this,arguments)){var started,i,t,p,touches=event.touches,n=touches.length,g=gesture(this,args,event.changedTouches.length===n).event(event);for(noevent_nopropagation(event),i=0;i<n;++i)p=[p=pointer(t=touches[i],this),this.__zoom.invert(p),t.identifier],g.touch0?g.touch1||g.touch0[2]===p[2]||(g.touch1=p,g.taps=0):(g.touch0=p,started=!0,g.taps=1+!!touchstarting);touchstarting&&(touchstarting=clearTimeout(touchstarting)),started&&(g.taps<2&&(touchfirst=p[0],touchstarting=setTimeout((function(){touchstarting=null}),touchDelay)),interrupt(this),g.start())}}function touchmoved(event,...args){if(this.__zooming){var i,t,p,l,g=gesture(this,args).event(event),touches=event.changedTouches,n=touches.length;for(src_noevent(event),i=0;i<n;++i)p=pointer(t=touches[i],this),g.touch0&&g.touch0[2]===t.identifier?g.touch0[0]=p:g.touch1&&g.touch1[2]===t.identifier&&(g.touch1[0]=p);if(t=g.that.__zoom,g.touch1){var p0=g.touch0[0],l0=g.touch0[1],p1=g.touch1[0],l1=g.touch1[1],dp=(dp=p1[0]-p0[0])*dp+(dp=p1[1]-p0[1])*dp,dl=(dl=l1[0]-l0[0])*dl+(dl=l1[1]-l0[1])*dl;t=scale(t,Math.sqrt(dp/dl)),p=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2]}else{if(!g.touch0)return;p=g.touch0[0],l=g.touch0[1]}g.zoom("touch",constrain(translate(t,p,l),g.extent,translateExtent))}}function touchended(event,...args){if(this.__zooming){var i,t,g=gesture(this,args).event(event),touches=event.changedTouches,n=touches.length;for(noevent_nopropagation(event),touchending&&clearTimeout(touchending),touchending=setTimeout((function(){touchending=null}),touchDelay),i=0;i<n;++i)t=touches[i],g.touch0&&g.touch0[2]===t.identifier?delete g.touch0:g.touch1&&g.touch1[2]===t.identifier&&delete g.touch1;if(g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0)g.touch0[1]=this.__zoom.invert(g.touch0[0]);else if(g.end(),2===g.taps&&(t=pointer(t,this),Math.hypot(touchfirst[0]-t[0],touchfirst[1]-t[1])<tapDistance)){var p=src_select(this).on("dblclick.zoom");p&&p.apply(this,arguments)}}}return zoom.transform=function(collection,transform,point,event){var selection=collection.selection?collection.selection():collection;selection.property("__zoom",defaultTransform),collection!==selection?schedule(collection,transform,point,event):selection.interrupt().each((function(){gesture(this,arguments).event(event).start().zoom(null,"function"==typeof transform?transform.apply(this,arguments):transform).end()}))},zoom.scaleBy=function(selection,k,p,event){zoom.scaleTo(selection,(function(){return this.__zoom.k*("function"==typeof k?k.apply(this,arguments):k)}),p,event)},zoom.scaleTo=function(selection,k,p,event){zoom.transform(selection,(function(){var e=extent.apply(this,arguments),t0=this.__zoom,p0=null==p?centroid(e):"function"==typeof p?p.apply(this,arguments):p,p1=t0.invert(p0),k1="function"==typeof k?k.apply(this,arguments):k;return constrain(translate(scale(t0,k1),p0,p1),e,translateExtent)}),p,event)},zoom.translateBy=function(selection,x,y,event){zoom.transform(selection,(function(){return constrain(this.__zoom.translate("function"==typeof x?x.apply(this,arguments):x,"function"==typeof y?y.apply(this,arguments):y),extent.apply(this,arguments),translateExtent)}),null,event)},zoom.translateTo=function(selection,x,y,p,event){zoom.transform(selection,(function(){var e=extent.apply(this,arguments),t=this.__zoom,p0=null==p?centroid(e):"function"==typeof p?p.apply(this,arguments):p;return constrain(transform_identity.translate(p0[0],p0[1]).scale(t.k).translate("function"==typeof x?-x.apply(this,arguments):-x,"function"==typeof y?-y.apply(this,arguments):-y),e,translateExtent)}),p,event)},Gesture.prototype={event:function(event){return event&&(this.sourceEvent=event),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(key,transform){return this.mouse&&"mouse"!==key&&(this.mouse[1]=transform.invert(this.mouse[0])),this.touch0&&"touch"!==key&&(this.touch0[1]=transform.invert(this.touch0[0])),this.touch1&&"touch"!==key&&(this.touch1[1]=transform.invert(this.touch1[0])),this.that.__zoom=transform,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(type){var d=src_select(this.that).datum();listeners.call(type,this.that,new ZoomEvent(type,{sourceEvent:this.sourceEvent,target:zoom,type,transform:this.that.__zoom,dispatch:listeners}),d)}},zoom.wheelDelta=function(_){return arguments.length?(wheelDelta="function"==typeof _?_:d3_zoom_src_constant(+_),zoom):wheelDelta},zoom.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_zoom_src_constant(!!_),zoom):filter},zoom.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_zoom_src_constant(!!_),zoom):touchable},zoom.extent=function(_){return arguments.length?(extent="function"==typeof _?_:d3_zoom_src_constant([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),zoom):extent},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent[0]=+_[0],scaleExtent[1]=+_[1],zoom):[scaleExtent[0],scaleExtent[1]]},zoom.translateExtent=function(_){return arguments.length?(translateExtent[0][0]=+_[0][0],translateExtent[1][0]=+_[1][0],translateExtent[0][1]=+_[0][1],translateExtent[1][1]=+_[1][1],zoom):[[translateExtent[0][0],translateExtent[0][1]],[translateExtent[1][0],translateExtent[1][1]]]},zoom.constrain=function(_){return arguments.length?(constrain=_,zoom):constrain},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.interpolate=function(_){return arguments.length?(interpolate=_,zoom):interpolate},zoom.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?zoom:value},zoom.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,zoom):Math.sqrt(clickDistance2)},zoom.tapDistance=function(_){return arguments.length?(tapDistance=+_,zoom):tapDistance},zoom}transform.prototype=Transform.prototype;const d3_drag_src_constant=x=>()=>x;function DragEvent(type,{sourceEvent,subject,target,identifier,active,x,y,dx,dy,dispatch}){Object.defineProperties(this,{type:{value:type,enumerable:!0,configurable:!0},sourceEvent:{value:sourceEvent,enumerable:!0,configurable:!0},subject:{value:subject,enumerable:!0,configurable:!0},target:{value:target,enumerable:!0,configurable:!0},identifier:{value:identifier,enumerable:!0,configurable:!0},active:{value:active,enumerable:!0,configurable:!0},x:{value:x,enumerable:!0,configurable:!0},y:{value:y,enumerable:!0,configurable:!0},dx:{value:dx,enumerable:!0,configurable:!0},dy:{value:dy,enumerable:!0,configurable:!0},_:{value:dispatch}})}function drag_defaultFilter(event){return!event.ctrlKey&&!event.button}function defaultContainer(){return this.parentNode}function defaultSubject(event,d){return null==d?{x:event.x,y:event.y}:d}function drag_defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function min(values,valueof){let min;if(void 0===valueof)for(const value of values)null!=value&&(min>value||void 0===min&&value>=value)&&(min=value);else{let index=-1;for(let value of values)null!=(value=valueof(value,++index,values))&&(min>value||void 0===min&&value>=value)&&(min=value)}return min}function max(values,valueof){let max;if(void 0===valueof)for(const value of values)null!=value&&(max<value||void 0===max&&value>=value)&&(max=value);else{let index=-1;for(let value of values)null!=(value=valueof(value,++index,values))&&(max<value||void 0===max&&value>=value)&&(max=value)}return max}DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};const lodash_es_isObject=function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)};const _freeGlobal="object"==typeof __webpack_require__.g&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g;var freeSelf="object"==typeof self&&self&&self.Object===Object&&self;const _root=_freeGlobal||freeSelf||Function("return this")();const lodash_es_now=function(){return _root.Date.now()};var reWhitespace=/\s/;const _trimmedEndIndex=function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index};var reTrimStart=/^\s+/;const _baseTrim=function baseTrim(string){return string?string.slice(0,_trimmedEndIndex(string)+1).replace(reTrimStart,""):string};const _Symbol=_root.Symbol;var objectProto=Object.prototype,_getRawTag_hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;const _getRawTag=function getRawTag(value){var isOwn=_getRawTag_hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result};var _objectToString_nativeObjectToString=Object.prototype.toString;const _objectToString=function objectToString(value){return _objectToString_nativeObjectToString.call(value)};var _baseGetTag_symToStringTag=_Symbol?_Symbol.toStringTag:void 0;const _baseGetTag=function baseGetTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":_baseGetTag_symToStringTag&&_baseGetTag_symToStringTag in Object(value)?_getRawTag(value):_objectToString(value)};const lodash_es_isObjectLike=function isObjectLike(value){return null!=value&&"object"==typeof value};const lodash_es_isSymbol=function isSymbol(value){return"symbol"==typeof value||lodash_es_isObjectLike(value)&&"[object Symbol]"==_baseGetTag(value)};var reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;const lodash_es_toNumber=function toNumber(value){if("number"==typeof value)return value;if(lodash_es_isSymbol(value))return NaN;if(lodash_es_isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=lodash_es_isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=_baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value};var nativeMax=Math.max,nativeMin=Math.min;const lodash_es_debounce=function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=lodash_es_now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function remainingWait(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=lodash_es_now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=lodash_es_toNumber(wait)||0,lodash_es_isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(lodash_es_toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function cancel(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function flush(){return void 0===timerId?result:trailingEdge(lodash_es_now())},debounced};const lodash_es_throttle=function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return lodash_es_isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),lodash_es_debounce(func,wait,{leading,maxWait:wait,trailing})};var Easing=Object.freeze({Linear:Object.freeze({None:function(amount){return amount},In:function(amount){return amount},Out:function(amount){return amount},InOut:function(amount){return amount}}),Quadratic:Object.freeze({In:function(amount){return amount*amount},Out:function(amount){return amount*(2-amount)},InOut:function(amount){return(amount*=2)<1?.5*amount*amount:-.5*(--amount*(amount-2)-1)}}),Cubic:Object.freeze({In:function(amount){return amount*amount*amount},Out:function(amount){return--amount*amount*amount+1},InOut:function(amount){return(amount*=2)<1?.5*amount*amount*amount:.5*((amount-=2)*amount*amount+2)}}),Quartic:Object.freeze({In:function(amount){return amount*amount*amount*amount},Out:function(amount){return 1- --amount*amount*amount*amount},InOut:function(amount){return(amount*=2)<1?.5*amount*amount*amount*amount:-.5*((amount-=2)*amount*amount*amount-2)}}),Quintic:Object.freeze({In:function(amount){return amount*amount*amount*amount*amount},Out:function(amount){return--amount*amount*amount*amount*amount+1},InOut:function(amount){return(amount*=2)<1?.5*amount*amount*amount*amount*amount:.5*((amount-=2)*amount*amount*amount*amount+2)}}),Sinusoidal:Object.freeze({In:function(amount){return 1-Math.sin((1-amount)*Math.PI/2)},Out:function(amount){return Math.sin(amount*Math.PI/2)},InOut:function(amount){return.5*(1-Math.sin(Math.PI*(.5-amount)))}}),Exponential:Object.freeze({In:function(amount){return 0===amount?0:Math.pow(1024,amount-1)},Out:function(amount){return 1===amount?1:1-Math.pow(2,-10*amount)},InOut:function(amount){return 0===amount?0:1===amount?1:(amount*=2)<1?.5*Math.pow(1024,amount-1):.5*(2-Math.pow(2,-10*(amount-1)))}}),Circular:Object.freeze({In:function(amount){return 1-Math.sqrt(1-amount*amount)},Out:function(amount){return Math.sqrt(1- --amount*amount)},InOut:function(amount){return(amount*=2)<1?-.5*(Math.sqrt(1-amount*amount)-1):.5*(Math.sqrt(1-(amount-=2)*amount)+1)}}),Elastic:Object.freeze({In:function(amount){return 0===amount?0:1===amount?1:-Math.pow(2,10*(amount-1))*Math.sin(5*(amount-1.1)*Math.PI)},Out:function(amount){return 0===amount?0:1===amount?1:Math.pow(2,-10*amount)*Math.sin(5*(amount-.1)*Math.PI)+1},InOut:function(amount){return 0===amount?0:1===amount?1:(amount*=2)<1?-.5*Math.pow(2,10*(amount-1))*Math.sin(5*(amount-1.1)*Math.PI):.5*Math.pow(2,-10*(amount-1))*Math.sin(5*(amount-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(amount){var s=1.70158;return 1===amount?1:amount*amount*((s+1)*amount-s)},Out:function(amount){var s=1.70158;return 0===amount?0:--amount*amount*((s+1)*amount+s)+1},InOut:function(amount){var s=2.5949095;return(amount*=2)<1?amount*amount*((s+1)*amount-s)*.5:.5*((amount-=2)*amount*((s+1)*amount+s)+2)}}),Bounce:Object.freeze({In:function(amount){return 1-Easing.Bounce.Out(1-amount)},Out:function(amount){return amount<1/2.75?7.5625*amount*amount:amount<2/2.75?7.5625*(amount-=1.5/2.75)*amount+.75:amount<2.5/2.75?7.5625*(amount-=2.25/2.75)*amount+.9375:7.5625*(amount-=2.625/2.75)*amount+.984375},InOut:function(amount){return amount<.5?.5*Easing.Bounce.In(2*amount):.5*Easing.Bounce.Out(2*amount-1)+.5}}),generatePow:function(power){return void 0===power&&(power=4),power=(power=power<Number.EPSILON?Number.EPSILON:power)>1e4?1e4:power,{In:function(amount){return Math.pow(amount,power)},Out:function(amount){return 1-Math.pow(1-amount,power)},InOut:function(amount){return amount<.5?Math.pow(2*amount,power)/2:(1-Math.pow(2-2*amount,power))/2+.5}}}}),tween_esm_now=function(){return performance.now()},Group=function(){function Group(){this._tweens={},this._tweensAddedDuringUpdate={}}return Group.prototype.getAll=function(){var _this=this;return Object.keys(this._tweens).map((function(tweenId){return _this._tweens[tweenId]}))},Group.prototype.removeAll=function(){this._tweens={}},Group.prototype.add=function(tween){this._tweens[tween.getId()]=tween,this._tweensAddedDuringUpdate[tween.getId()]=tween},Group.prototype.remove=function(tween){delete this._tweens[tween.getId()],delete this._tweensAddedDuringUpdate[tween.getId()]},Group.prototype.update=function(time,preserve){void 0===time&&(time=tween_esm_now()),void 0===preserve&&(preserve=!1);var tweenIds=Object.keys(this._tweens);if(0===tweenIds.length)return!1;for(;tweenIds.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<tweenIds.length;i++){var tween=this._tweens[tweenIds[i]],autoStart=!preserve;tween&&!1===tween.update(time,autoStart)&&!preserve&&delete this._tweens[tweenIds[i]]}tweenIds=Object.keys(this._tweensAddedDuringUpdate)}return!0},Group}(),Interpolation={Linear:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=Interpolation.Utils.Linear;return k<0?fn(v[0],v[1],f):k>1?fn(v[m],v[m-1],m-f):fn(v[i],v[i+1>m?m:i+1],f-i)},Bezier:function(v,k){for(var b=0,n=v.length-1,pw=Math.pow,bn=Interpolation.Utils.Bernstein,i=0;i<=n;i++)b+=pw(1-k,n-i)*pw(k,i)*v[i]*bn(n,i);return b},CatmullRom:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=Interpolation.Utils.CatmullRom;return v[0]===v[m]?(k<0&&(i=Math.floor(f=m*(1+k))),fn(v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m],f-i)):k<0?v[0]-(fn(v[0],v[0],v[1],v[1],-f)-v[0]):k>1?v[m]-(fn(v[m],v[m],v[m-1],v[m-1],f-m)-v[m]):fn(v[i?i-1:0],v[i],v[m<i+1?m:i+1],v[m<i+2?m:i+2],f-i)},Utils:{Linear:function(p0,p1,t){return(p1-p0)*t+p0},Bernstein:function(n,i){var fc=Interpolation.Utils.Factorial;return fc(n)/fc(i)/fc(n-i)},Factorial:function(){var a=[1];return function(n){var s=1;if(a[n])return a[n];for(var i=n;i>1;i--)s*=i;return a[n]=s,s}}(),CatmullRom:function(p0,p1,p2,p3,t){var v0=.5*(p2-p0),v1=.5*(p3-p1),t2=t*t;return(2*p1-2*p2+v0+v1)*(t*t2)+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1}}},Sequence=function(){function Sequence(){}return Sequence.nextId=function(){return Sequence._nextId++},Sequence._nextId=0,Sequence}(),mainGroup=new Group,Tween=function(){function Tween(_object,_group){void 0===_group&&(_group=mainGroup),this._object=_object,this._group=_group,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return Tween.prototype.getId=function(){return this._id},Tween.prototype.isPlaying=function(){return this._isPlaying},Tween.prototype.isPaused=function(){return this._isPaused},Tween.prototype.getDuration=function(){return this._duration},Tween.prototype.to=function(target,duration){if(void 0===duration&&(duration=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=target,this._propertiesAreSetUp=!1,this._duration=duration<0?0:duration,this},Tween.prototype.duration=function(duration){return void 0===duration&&(duration=1e3),this._duration=duration<0?0:duration,this},Tween.prototype.dynamic=function(dynamic){return void 0===dynamic&&(dynamic=!1),this._isDynamic=dynamic,this},Tween.prototype.start=function(time,overrideStartingValues){if(void 0===time&&(time=tween_esm_now()),void 0===overrideStartingValues&&(overrideStartingValues=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var property in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(property),this._valuesStart[property]=this._valuesStartRepeat[property];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=time,this._startTime+=this._delayTime,!this._propertiesAreSetUp||overrideStartingValues){if(this._propertiesAreSetUp=!0,!this._isDynamic){var tmp={};for(var prop in this._valuesEnd)tmp[prop]=this._valuesEnd[prop];this._valuesEnd=tmp}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,overrideStartingValues)}return this},Tween.prototype.startFromCurrentValues=function(time){return this.start(time,!0)},Tween.prototype._setupProperties=function(_object,_valuesStart,_valuesEnd,_valuesStartRepeat,overrideStartingValues){for(var property in _valuesEnd){var startValue=_object[property],startValueIsArray=Array.isArray(startValue),propType=startValueIsArray?"array":typeof startValue,isInterpolationList=!startValueIsArray&&Array.isArray(_valuesEnd[property]);if("undefined"!==propType&&"function"!==propType){if(isInterpolationList){if(0===(endValues=_valuesEnd[property]).length)continue;for(var temp=[startValue],i=0,l=endValues.length;i<l;i+=1){var value=this._handleRelativeValue(startValue,endValues[i]);if(isNaN(value)){isInterpolationList=!1,console.warn("Found invalid interpolation list. Skipping.");break}temp.push(value)}isInterpolationList&&(_valuesEnd[property]=temp)}if("object"!==propType&&!startValueIsArray||!startValue||isInterpolationList)(void 0===_valuesStart[property]||overrideStartingValues)&&(_valuesStart[property]=startValue),startValueIsArray||(_valuesStart[property]*=1),_valuesStartRepeat[property]=isInterpolationList?_valuesEnd[property].slice().reverse():_valuesStart[property]||0;else{_valuesStart[property]=startValueIsArray?[]:{};var nestedObject=startValue;for(var prop in nestedObject)_valuesStart[property][prop]=nestedObject[prop];_valuesStartRepeat[property]=startValueIsArray?[]:{};var endValues=_valuesEnd[property];if(!this._isDynamic){var tmp={};for(var prop in endValues)tmp[prop]=endValues[prop];_valuesEnd[property]=endValues=tmp}this._setupProperties(nestedObject,_valuesStart[property],endValues,_valuesStartRepeat[property],overrideStartingValues)}}}},Tween.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},Tween.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},Tween.prototype.pause=function(time){return void 0===time&&(time=tween_esm_now()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=time,this._group&&this._group.remove(this)),this},Tween.prototype.resume=function(time){return void 0===time&&(time=tween_esm_now()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=time-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},Tween.prototype.stopChainedTweens=function(){for(var i=0,numChainedTweens=this._chainedTweens.length;i<numChainedTweens;i++)this._chainedTweens[i].stop();return this},Tween.prototype.group=function(group){return void 0===group&&(group=mainGroup),this._group=group,this},Tween.prototype.delay=function(amount){return void 0===amount&&(amount=0),this._delayTime=amount,this},Tween.prototype.repeat=function(times){return void 0===times&&(times=0),this._initialRepeat=times,this._repeat=times,this},Tween.prototype.repeatDelay=function(amount){return this._repeatDelayTime=amount,this},Tween.prototype.yoyo=function(yoyo){return void 0===yoyo&&(yoyo=!1),this._yoyo=yoyo,this},Tween.prototype.easing=function(easingFunction){return void 0===easingFunction&&(easingFunction=Easing.Linear.None),this._easingFunction=easingFunction,this},Tween.prototype.interpolation=function(interpolationFunction){return void 0===interpolationFunction&&(interpolationFunction=Interpolation.Linear),this._interpolationFunction=interpolationFunction,this},Tween.prototype.chain=function(){for(var tweens=[],_i=0;_i<arguments.length;_i++)tweens[_i]=arguments[_i];return this._chainedTweens=tweens,this},Tween.prototype.onStart=function(callback){return this._onStartCallback=callback,this},Tween.prototype.onEveryStart=function(callback){return this._onEveryStartCallback=callback,this},Tween.prototype.onUpdate=function(callback){return this._onUpdateCallback=callback,this},Tween.prototype.onRepeat=function(callback){return this._onRepeatCallback=callback,this},Tween.prototype.onComplete=function(callback){return this._onCompleteCallback=callback,this},Tween.prototype.onStop=function(callback){return this._onStopCallback=callback,this},Tween.prototype.update=function(time,autoStart){var _a,property,_this=this;if(void 0===time&&(time=tween_esm_now()),void 0===autoStart&&(autoStart=!0),this._isPaused)return!0;var endTime=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(time>endTime)return!1;autoStart&&this.start(time,!0)}if(this._goToEnd=!1,time<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var elapsedTime=time-this._startTime,durationAndDelay=this._duration+(null!==(_a=this._repeatDelayTime)&&void 0!==_a?_a:this._delayTime),totalTime=this._duration+this._repeat*durationAndDelay,elapsed=function(){if(0===_this._duration)return 1;if(elapsedTime>totalTime)return 1;var timesRepeated=Math.trunc(elapsedTime/durationAndDelay),timeIntoCurrentRepeat=elapsedTime-timesRepeated*durationAndDelay,portion=Math.min(timeIntoCurrentRepeat/_this._duration,1);return 0===portion&&elapsedTime===_this._duration?1:portion}(),value=this._easingFunction(elapsed);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,value),this._onUpdateCallback&&this._onUpdateCallback(this._object,elapsed),0===this._duration||elapsedTime>=this._duration){if(this._repeat>0){var completeCount=Math.min(Math.trunc((elapsedTime-this._duration)/durationAndDelay)+1,this._repeat);for(property in isFinite(this._repeat)&&(this._repeat-=completeCount),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[property]||(this._valuesStartRepeat[property]=this._valuesStartRepeat[property]+parseFloat(this._valuesEnd[property])),this._yoyo&&this._swapEndStartRepeatValues(property),this._valuesStart[property]=this._valuesStartRepeat[property];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=durationAndDelay*completeCount,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var i=0,numChainedTweens=this._chainedTweens.length;i<numChainedTweens;i++)this._chainedTweens[i].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},Tween.prototype._updateProperties=function(_object,_valuesStart,_valuesEnd,value){for(var property in _valuesEnd)if(void 0!==_valuesStart[property]){var start=_valuesStart[property]||0,end=_valuesEnd[property],startIsArray=Array.isArray(_object[property]),endIsArray=Array.isArray(end);!startIsArray&&endIsArray?_object[property]=this._interpolationFunction(end,value):"object"==typeof end&&end?this._updateProperties(_object[property],start,end,value):"number"==typeof(end=this._handleRelativeValue(start,end))&&(_object[property]=start+(end-start)*value)}},Tween.prototype._handleRelativeValue=function(start,end){return"string"!=typeof end?end:"+"===end.charAt(0)||"-"===end.charAt(0)?start+parseFloat(end):parseFloat(end)},Tween.prototype._swapEndStartRepeatValues=function(property){var tmp=this._valuesStartRepeat[property],endValue=this._valuesEnd[property];this._valuesStartRepeat[property]="string"==typeof endValue?this._valuesStartRepeat[property]+parseFloat(endValue):this._valuesEnd[property],this._valuesEnd[property]=tmp},Tween}(),TWEEN=(Sequence.nextId,mainGroup);TWEEN.getAll.bind(TWEEN),TWEEN.removeAll.bind(TWEEN),TWEEN.add.bind(TWEEN),TWEEN.remove.bind(TWEEN),TWEEN.update.bind(TWEEN);function kapsule_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _createClass(e,r,t){return Object.defineProperty(e,"prototype",{writable:!1}),e}function kapsule_slicedToArray(r,e){return function kapsule_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function kapsule_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l);else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function kapsule_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return kapsule_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?kapsule_arrayLikeToArray(r,a):void 0}}(r,e)||function kapsule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Prop=_createClass((function Prop(name,_ref){var _ref$default=_ref.default,defaultVal=void 0===_ref$default?null:_ref$default,_ref$triggerUpdate=_ref.triggerUpdate,triggerUpdate=void 0===_ref$triggerUpdate||_ref$triggerUpdate,_ref$onChange=_ref.onChange,onChange=void 0===_ref$onChange?function(newVal,state){}:_ref$onChange;!function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,Prop),this.name=name,this.defaultVal=defaultVal,this.triggerUpdate=triggerUpdate,this.onChange=onChange}));function kapsule_index(_ref2){var _ref2$stateInit=_ref2.stateInit,stateInit=void 0===_ref2$stateInit?function(){return{}}:_ref2$stateInit,_ref2$props=_ref2.props,rawProps=void 0===_ref2$props?{}:_ref2$props,_ref2$methods=_ref2.methods,methods=void 0===_ref2$methods?{}:_ref2$methods,_ref2$aliases=_ref2.aliases,aliases=void 0===_ref2$aliases?{}:_ref2$aliases,_ref2$init=_ref2.init,initFn=void 0===_ref2$init?function(){}:_ref2$init,_ref2$update=_ref2.update,updateFn=void 0===_ref2$update?function(){}:_ref2$update,props=Object.keys(rawProps).map((function(propName){return new Prop(propName,rawProps[propName])}));return function KapsuleComp(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var classMode=!!(this instanceof KapsuleComp?this.constructor:void 0),nodeElement=classMode?args.shift():void 0,_args$=args[0],options=void 0===_args$?{}:_args$,state=Object.assign({},stateInit instanceof Function?stateInit(options):stateInit,{initialised:!1}),changedProps={};function comp(nodeElement){return initStatic(nodeElement,options),digest(),comp}var initStatic=function initStatic(nodeElement,options){initFn.call(comp,nodeElement,state,options),state.initialised=!0},digest=lodash_es_debounce((function(){state.initialised&&(updateFn.call(comp,state,changedProps),changedProps={})}),1);return props.forEach((function(prop){comp[prop.name]=function getSetProp(_ref3){var prop=_ref3.name,_ref3$triggerUpdate=_ref3.triggerUpdate,redigest=void 0!==_ref3$triggerUpdate&&_ref3$triggerUpdate,_ref3$onChange=_ref3.onChange,onChange=void 0===_ref3$onChange?function(newVal,state){}:_ref3$onChange,_ref3$defaultVal=_ref3.defaultVal,defaultVal=void 0===_ref3$defaultVal?null:_ref3$defaultVal;return function(_){var curVal=state[prop];if(!arguments.length)return curVal;var val=void 0===_?defaultVal:_;return state[prop]=val,onChange.call(comp,val,state,curVal),!changedProps.hasOwnProperty(prop)&&(changedProps[prop]=curVal),redigest&&digest(),comp}}(prop)})),Object.keys(methods).forEach((function(methodName){comp[methodName]=function(){for(var _methods$methodName,_len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return(_methods$methodName=methods[methodName]).call.apply(_methods$methodName,[comp,state].concat(args))}})),Object.entries(aliases).forEach((function(_ref4){var _ref5=kapsule_slicedToArray(_ref4,2),alias=_ref5[0],target=_ref5[1];return comp[alias]=comp[target]})),comp.resetProps=function(){return props.forEach((function(prop){comp[prop.name](prop.defaultVal)})),comp},comp.resetProps(),state._rerender=digest,classMode&&nodeElement&&comp(nodeElement),comp}}var accessor_fn_index=function(p){return"function"==typeof p?p:"string"==typeof p?function(obj){return obj[p]}:function(obj){return p}};function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(color,opts){if(opts=opts||{},(color=color||"")instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,s=null,v=null,l=null,ok=!1,format=!1;"string"==typeof color&&(color=function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var match,named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};if(match=matchers.rgb.exec(color))return{r:match[1],g:match[2],b:match[3]};if(match=matchers.rgba.exec(color))return{r:match[1],g:match[2],b:match[3],a:match[4]};if(match=matchers.hsl.exec(color))return{h:match[1],s:match[2],l:match[3]};if(match=matchers.hsla.exec(color))return{h:match[1],s:match[2],l:match[3],a:match[4]};if(match=matchers.hsv.exec(color))return{h:match[1],s:match[2],v:match[3]};if(match=matchers.hsva.exec(color))return{h:match[1],s:match[2],v:match[3],a:match[4]};if(match=matchers.hex8.exec(color))return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),a:convertHexToDecimal(match[4]),format:named?"name":"hex8"};if(match=matchers.hex6.exec(color))return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"};if(match=matchers.hex4.exec(color))return{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),a:convertHexToDecimal(match[4]+""+match[4]),format:named?"name":"hex8"};if(match=matchers.hex3.exec(color))return{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"};return!1}(color));"object"==_typeof(color)&&(isValidCSSUnit(color.r)&&isValidCSSUnit(color.g)&&isValidCSSUnit(color.b)?(rgb=function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.v)?(s=convertToPercentage(color.s),v=convertToPercentage(color.v),rgb=function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}(color.h,s,v),ok=!0,format="hsv"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.l)&&(s=convertToPercentage(color.s),l=convertToPercentage(color.l),rgb=function hslToRgb(h,s,l){var r,g,b;function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}(color.h,s,l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a));return a=boundAlpha(a),{ok,format:color.format||format,r:Math.min(255,Math.max(rgb.r,0)),g:Math.min(255,Math.max(rgb.g,0)),b:Math.min(255,Math.max(rgb.b,0)),a}}(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=Math.round(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=rgb.ok}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h,s,l}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h,s,v}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(Math.round(r).toString(16)),pad2(Math.round(g).toString(16)),pad2(Math.round(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToArgbHex(r,g,b,a){return[pad2(convertDecimalToHex(a)),pad2(Math.round(r).toString(16)),pad2(Math.round(g).toString(16)),pad2(Math.round(b).toString(16))].join("")}function _desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function _saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function _greyscale(color){return tinycolor(color).desaturate(100)}function _lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function _brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=Math.max(0,Math.min(255,rgb.r-Math.round(-amount/100*255))),rgb.g=Math.max(0,Math.min(255,rgb.g-Math.round(-amount/100*255))),rgb.b=Math.max(0,Math.min(255,rgb.b-Math.round(-amount/100*255))),tinycolor(rgb)}function _darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function _spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(hsl.h+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function _complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function polyad(color,number){if(isNaN(number)||number<=0)throw new Error("Argument to polyad must be a positive number");for(var hsl=tinycolor(color).toHsl(),result=[tinycolor(color)],step=360/number,i=1;i<number;i++)result.push(tinycolor({h:(hsl.h+i*step)%360,s:hsl.s,l:hsl.l}));return result}function _splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function _analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function _monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h,s,v})),v=(v+modification)%1;return ret}tinycolor.prototype={isDark:function isDark(){return this.getBrightness()<128},isLight:function isLight(){return!this.isDark()},isValid:function isValid(){return this._ok},getOriginalInput:function getOriginalInput(){return this._originalInput},getFormat:function getFormat(){return this._format},getAlpha:function getAlpha(){return this._a},getBrightness:function getBrightness(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},getLuminance:function getLuminance(){var RsRGB,GsRGB,BsRGB,rgb=this.toRgb();return RsRGB=rgb.r/255,GsRGB=rgb.g/255,BsRGB=rgb.b/255,.2126*(RsRGB<=.03928?RsRGB/12.92:Math.pow((RsRGB+.055)/1.055,2.4))+.7152*(GsRGB<=.03928?GsRGB/12.92:Math.pow((GsRGB+.055)/1.055,2.4))+.0722*(BsRGB<=.03928?BsRGB/12.92:Math.pow((BsRGB+.055)/1.055,2.4))},setAlpha:function setAlpha(value){return this._a=boundAlpha(value),this._roundA=Math.round(100*this._a)/100,this},toHsv:function toHsv(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function toHsvString(){var hsv=rgbToHsv(this._r,this._g,this._b),h=Math.round(360*hsv.h),s=Math.round(100*hsv.s),v=Math.round(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function toHsl(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function toHslString(){var hsl=rgbToHsl(this._r,this._g,this._b),h=Math.round(360*hsl.h),s=Math.round(100*hsl.s),l=Math.round(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function toHex(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function toHexString(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function toHex8(allow4Char){return function rgbaToHex(r,g,b,a,allow4Char){var hex=[pad2(Math.round(r).toString(16)),pad2(Math.round(g).toString(16)),pad2(Math.round(b).toString(16)),pad2(convertDecimalToHex(a))];if(allow4Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)&&hex[3].charAt(0)==hex[3].charAt(1))return hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0)+hex[3].charAt(0);return hex.join("")}(this._r,this._g,this._b,this._a,allow4Char)},toHex8String:function toHex8String(allow4Char){return"#"+this.toHex8(allow4Char)},toRgb:function toRgb(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function toRgbString(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function toPercentageRgb(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function toPercentageRgbString(){return 1==this._a?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function toName(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function toFilter(secondColor){var hex8String="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String="#"+rgbaToArgbHex(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function toString(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0;return formatSet||!hasAlpha||"hex"!==format&&"hex6"!==format&&"hex3"!==format&&"hex4"!==format&&"hex8"!==format&&"name"!==format?("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex4"===format&&(formattedString=this.toHex8String(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString()):"name"===format&&0===this._a?this.toName():this.toRgbString()},clone:function clone(){return tinycolor(this.toString())},_applyModification:function _applyModification(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function lighten(){return this._applyModification(_lighten,arguments)},brighten:function brighten(){return this._applyModification(_brighten,arguments)},darken:function darken(){return this._applyModification(_darken,arguments)},desaturate:function desaturate(){return this._applyModification(_desaturate,arguments)},saturate:function saturate(){return this._applyModification(_saturate,arguments)},greyscale:function greyscale(){return this._applyModification(_greyscale,arguments)},spin:function spin(){return this._applyModification(_spin,arguments)},_applyCombination:function _applyCombination(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function analogous(){return this._applyCombination(_analogous,arguments)},complement:function complement(){return this._applyCombination(_complement,arguments)},monochromatic:function monochromatic(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function splitcomplement(){return this._applyCombination(_splitcomplement,arguments)},triad:function triad(){return this._applyCombination(polyad,[3])},tetrad:function tetrad(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(color,opts){if("object"==_typeof(color)){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100;return tinycolor({r:(rgb2.r-rgb1.r)*p+rgb1.r,g:(rgb2.g-rgb1.g)*p+rgb1.g,b:(rgb2.b-rgb1.b)*p+rgb1.b,a:(rgb2.a-rgb1.a)*p+rgb1.a})},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2);return(Math.max(c1.getLuminance(),c2.getLuminance())+.05)/(Math.min(c1.getLuminance(),c2.getLuminance())+.05)},tinycolor.isReadable=function(color1,color2,wcag2){var wcag2Parms,out,readability=tinycolor.readability(color1,color2);switch(out=!1,wcag2Parms=function validateWCAG2Parms(parms){var level,size;level=((parms=parms||{level:"AA",size:"small"}).level||"AA").toUpperCase(),size=(parms.size||"small").toLowerCase(),"AA"!==level&&"AAA"!==level&&(level="AA");"small"!==size&&"large"!==size&&(size="small");return{level,size}}(wcag2),wcag2Parms.level+wcag2Parms.size){case"AAsmall":case"AAAlarge":out=readability>=4.5;break;case"AAlarge":out=readability>=3;break;case"AAAsmall":out=readability>=7}return out},tinycolor.mostReadable=function(baseColor,colorList,args){var readability,includeFallbackColors,level,size,bestColor=null,bestScore=0;includeFallbackColors=(args=args||{}).includeFallbackColors,level=args.level,size=args.size;for(var i=0;i<colorList.length;i++)(readability=tinycolor.readability(baseColor,colorList[i]))>bestScore&&(bestScore=readability,bestColor=tinycolor(colorList[i]));return tinycolor.isReadable(baseColor,bestColor,{level,size})||!includeFallbackColors?bestColor:(args.includeFallbackColors=!1,tinycolor.mostReadable(baseColor,["#fff","#000"],args))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}(names);function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){(function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)})(n)&&(n="100%");var processPercent=function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}(n);return n=Math.min(max,Math.max(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),Math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return Math.min(1,Math.max(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}var CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4,matchers=(PERMISSIVE_MATCH3="[\\s|\\(]+("+(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function isValidCSSUnit(color){return!!matchers.CSS_UNIT.exec(color)}function canvas_color_tracker_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _assertClassBrand(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function _classPrivateFieldGet2(s,a){return s.get(_assertClassBrand(s,a))}function _classPrivateFieldInitSpec(e,t,a){(function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,a)}function _classPrivateFieldSet2(s,a,r){return s.set(_assertClassBrand(s,a),r),r}function canvas_color_tracker_createClass(e,r,t){return r&&function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,canvas_color_tracker_toPropertyKey(o.key),o)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function canvas_color_tracker_toConsumableArray(r){return function canvas_color_tracker_arrayWithoutHoles(r){if(Array.isArray(r))return canvas_color_tracker_arrayLikeToArray(r)}(r)||function canvas_color_tracker_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function canvas_color_tracker_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return canvas_color_tracker_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?canvas_color_tracker_arrayLikeToArray(r,a):void 0}}(r)||function canvas_color_tracker_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function canvas_color_tracker_toPropertyKey(t){var i=function canvas_color_tracker_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof i?i:i+""}var n,l,u,preact_module_t,i,r,o,e,f,c,s,a,rgb2Int=function rgb2Int(r,g,b){return(r<<16)+(g<<8)+b},checksum=function checksum(n,csBits){return 123*n%Math.pow(2,csBits)},_registry=new WeakMap,_csBits=new WeakMap,_default=function(){return canvas_color_tracker_createClass((function _default(){var csBits=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;!function canvas_color_tracker_classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,_default),_classPrivateFieldInitSpec(this,_registry,void 0),_classPrivateFieldInitSpec(this,_csBits,void 0),_classPrivateFieldSet2(_csBits,this,csBits),this.reset()}),[{key:"reset",value:function reset(){_classPrivateFieldSet2(_registry,this,["__reserved for background__"])}},{key:"register",value:function register(obj){if(_classPrivateFieldGet2(_registry,this).length>=Math.pow(2,24-_classPrivateFieldGet2(_csBits,this)))return null;var idx=_classPrivateFieldGet2(_registry,this).length,color=function int2HexColor(num){return"#".concat(Math.min(num,Math.pow(2,24)).toString(16).padStart(6,"0"))}(idx+(checksum(idx,_classPrivateFieldGet2(_csBits,this))<<24-_classPrivateFieldGet2(_csBits,this)));return _classPrivateFieldGet2(_registry,this).push(obj),color}},{key:"lookup",value:function lookup(color){if(!color)return null;var n="string"==typeof color?function colorStr2Int(str){var _tinyColor$toRgb=tinycolor(str).toRgb(),r=_tinyColor$toRgb.r,g=_tinyColor$toRgb.g,b=_tinyColor$toRgb.b;return rgb2Int(r,g,b)}(color):rgb2Int.apply(void 0,canvas_color_tracker_toConsumableArray(color));if(!n)return null;var idx=n&Math.pow(2,24-_classPrivateFieldGet2(_csBits,this))-1,cs=n>>24-_classPrivateFieldGet2(_csBits,this)&Math.pow(2,_classPrivateFieldGet2(_csBits,this))-1;return checksum(idx,_classPrivateFieldGet2(_csBits,this))!==cs||idx>=_classPrivateFieldGet2(_registry,this).length?null:_classPrivateFieldGet2(_registry,this)[idx]}}])}(),p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return"function"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,N(f,t,c),t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,y,w,d,g,_=t&&t.__k||v,m=l.length;for(f=P(u,l,_,f,m),a=0;a<m;a++)null!=(y=u.__k[a])&&(h=-1==y.__i?p:_[y.__i]||p,y.__i=a,g=O(n,y,h,i,r,o,e,f,c,s),w=y.__e,y.ref&&h.ref!=y.ref&&(h.ref&&B(h.ref,null,y),s.push(y.ref,y.__c||w,y)),null==d&&null!=w&&(d=w),4&y.__u||h.__k===y.__k?f=A(y,f,n):"function"==typeof y.type&&void 0!==g?f=g:w&&(f=w.nextSibling),y.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&"boolean"!=typeof o&&"function"!=typeof o?(f=r+h,(o=n.__k[r]="string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),"function"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&!(2&e.__u)&&(e.__e==t&&(t=S(e)),D(e,e));return t}function A(n,l,u){var t,i;if("function"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=A(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=S(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function L(n,l,u,t){var i,r,o,e=n.key,f=n.type,c=l[u],s=null!=c&&!(2&c.__u);if(null===c&&null==n.key||s&&e==c.key&&f==c.type)return u;if(t>(s?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;)if(null!=(c=l[o=i>=0?i--:r++])&&!(2&c.__u)&&e==c.key&&f==c.type)return o;return-1}function T(n,l,u){"-"==l[0]?n.setProperty(l,null==u?"":u):n[l]=null==u?"":"number"!=typeof u||y.test(l)?u:u+"px"}function j(n,l,u,t,i){var r,o;n:if("style"==l)if("string"==typeof u)n.style.cssText=u;else{if("string"==typeof t&&(n.style.cssText=t=""),t)for(l in t)u&&l in u||T(n.style,l,"");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if("o"==l[0]&&"n"==l[1])r=l!=(l=l.replace(f,"$1")),o=l.toLowerCase(),l=o in n||"onFocusOut"==l||"onFocusIn"==l?o.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if("http://www.w3.org/2000/svg"==i)l=l.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=l&&"height"!=l&&"href"!=l&&"list"!=l&&"form"!=l&&"tabIndex"!=l&&"download"!=l&&"rowSpan"!=l&&"colSpan"!=l&&"role"!=l&&"popover"!=l&&l in n)try{n[l]=null==u?"":u;break n}catch(n){}"function"==typeof u||(null==u||!1===u&&"-"!=l[4]?n.removeAttribute(l):n.setAttribute(l,"popover"==l&&1==u?"":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,v,y,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if("function"==typeof j)try{if(b=u.props,S="prototype"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=E),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some((function(n){n&&(n.__=u)})),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(v,y,_)}))}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,y)),L=a,null!=a&&a.type===k&&null==a.key&&(L=V(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else{for(T=o.length;T--;)g(o[T]);z(u)}else u.__e=t.__e,u.__k=t.__k,n.then||z(u);l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=q(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(z)}function N(n,u,t){for(var i=0;i<t.length;i++)B(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some((function(u){try{n=u.__h,u.__h=[],n.some((function(n){n.call(u)}))}catch(n){l.__e(n,u.__v)}}))}function V(n){return"object"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(V):d({},n)}function q(u,t,i,r,o,e,f,c,s){var a,h,v,y,d,_,m,b=i.props,k=t.props,x=t.type;if("svg"==x?o="http://www.w3.org/2000/svg":"math"==x?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&"setAttribute"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],"children"==a);else if("dangerouslySetInnerHTML"==a)v=d;else if(!(a in k)){if("value"==a&&"defaultValue"in k||"checked"==a&&"defaultChecked"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],"children"==a?y=d:"dangerouslySetInnerHTML"==a?h=d:"value"==a?_=d:"checked"==a?m=d:c&&"function"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||v&&(h.__html==v.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(v&&(u.innerHTML=""),I("template"==t.type?u.content:u,w(y)?y:[y],t,i,r,"foreignObject"==x?"http://www.w3.org/1999/xhtml":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a="value","progress"==x&&null==_?u.removeAttribute("value"):null!=_&&(_!==u[a]||"progress"==x&&!_||"option"==x&&_!=b[a])&&j(u,a,_,b[a],o),a="checked",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function B(n,u,t){try{if("function"==typeof n){var i="function"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function D(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||B(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&D(i[r],u,t||"function"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function E(n,l,u){return this.constructor(n,u)}function G(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r="function"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=function _(l,u,t){var i,r,o,e={};for(o in u)"key"==o?i=u[o]:"ref"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),"function"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)void 0===e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),N(e,u,f)}function K(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)"key"==o?i=u[o]:"ref"==o?r=u[o]:f[o]=void 0===u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function float_tooltip_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function float_tooltip_defineProperty(e,r,t){return(r=function float_tooltip_toPropertyKey(t){var i=function float_tooltip_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function float_tooltip_slicedToArray(r,e){return function float_tooltip_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function float_tooltip_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l);else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function float_tooltip_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return float_tooltip_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?float_tooltip_arrayLikeToArray(r,a):void 0}}(r,e)||function float_tooltip_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function float_tooltip_typeof(o){return float_tooltip_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},float_tooltip_typeof(o)}n=v.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,preact_module_t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),"function"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0);var _reactElement2VNode=function reactElement2VNode(el){if("object"!==float_tooltip_typeof(el))return el;var _res$props,res=K(el);res.props&&(res.props=function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){float_tooltip_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},res.props),null!=res&&null!==(_res$props=res.props)&&void 0!==_res$props&&_res$props.children&&(res.props.children=Array.isArray(res.props.children)?res.props.children.map(_reactElement2VNode):_reactElement2VNode(res.props.children)));return res};!function styleInject(css,ref){void 0===ref&&(ref={});var insertAt=ref.insertAt;if("undefined"!=typeof document){var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css","top"===insertAt&&head.firstChild?head.insertBefore(style,head.firstChild):head.appendChild(style),style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css))}}(".float-tooltip-kap {\n  position: absolute;\n  width: max-content; /* prevent shrinking near right edge */\n  max-width: max(50%, 150px);\n  padding: 3px 5px;\n  border-radius: 3px;\n  font: 12px sans-serif;\n  color: #eee;\n  background: rgba(0,0,0,0.6);\n  pointer-events: none;\n}\n");var float_tooltip_index=kapsule_index({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function init(domNode,state){var _ref$style=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).style,style=void 0===_ref$style?{}:_ref$style,el=src_select(!!domNode&&"object"===float_tooltip_typeof(domNode)&&!!domNode.node&&"function"==typeof domNode.node?domNode.node():domNode);"static"===el.style("position")&&el.style("position","relative"),state.tooltipEl=el.append("div").attr("class","float-tooltip-kap"),Object.entries(style).forEach((function(_ref2){var _ref3=float_tooltip_slicedToArray(_ref2,2),k=_ref3[0],v=_ref3[1];return state.tooltipEl.style(k,v)})),state.tooltipEl.style("left","-10000px").style("display","none");var evSuffix="tooltip-".concat(Math.round(1e12*Math.random()));state.mouseInside=!1,el.on("mousemove.".concat(evSuffix),(function(ev){state.mouseInside=!0;var mousePos=pointer(ev),domNode=el.node(),canvasWidth=domNode.offsetWidth,canvasHeight=domNode.offsetHeight,translate=[null===state.offsetX||void 0===state.offsetX?"-".concat(mousePos[0]/canvasWidth*100,"%"):"number"==typeof state.offsetX?"calc(-50% + ".concat(state.offsetX,"px)"):state.offsetX,null===state.offsetY||void 0===state.offsetY?canvasHeight>130&&canvasHeight-mousePos[1]<100?"calc(-100% - 6px)":"21px":"number"==typeof state.offsetY?state.offsetY<0?"calc(-100% - ".concat(Math.abs(state.offsetY),"px)"):"".concat(state.offsetY,"px"):state.offsetY];state.tooltipEl.style("left",mousePos[0]+"px").style("top",mousePos[1]+"px").style("transform","translate(".concat(translate.join(","),")")),state.content&&state.tooltipEl.style("display","inline")})),el.on("mouseover.".concat(evSuffix),(function(){state.mouseInside=!0,state.content&&state.tooltipEl.style("display","inline")})),el.on("mouseout.".concat(evSuffix),(function(){state.mouseInside=!1,state.tooltipEl.style("display","none")}))},update:function update(state){state.tooltipEl.style("display",state.content&&state.mouseInside?"inline":"none"),state.content?state.content instanceof HTMLElement?(state.tooltipEl.text(""),state.tooltipEl.append((function(){return state.content}))):"string"==typeof state.content?state.tooltipEl.html(state.content):function isReactRenderable(o){return preact_module_t(K(o))}(state.content)?(state.tooltipEl.text(""),function render(jsx,domEl){delete domEl.__k,G(_reactElement2VNode(jsx),domEl)}(state.content,state.tooltipEl.node())):(state.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",state.content,state.content.toString())):state.tooltipEl.text("")}});const lcg_a=1664525,lcg_c=1013904223,lcg_m=4294967296;function simulation_x(d){return d.x}function simulation_y(d){return d.y}function simulation_z(d){return d.z}var initialAngleRoll=Math.PI*(3-Math.sqrt(5)),initialAngleYaw=20*Math.PI/(9+Math.sqrt(221));function simulation(nodes,numDimensions){numDimensions=numDimensions||2;var simulation,nDim=Math.min(3,Math.max(1,Math.round(numDimensions))),alpha=1,alphaMin=.001,alphaDecay=1-Math.pow(alphaMin,1/300),alphaTarget=0,velocityDecay=.6,forces=new Map,stepper=timer(step),event=src_dispatch("tick","end"),random=function lcg(){let s=1;return()=>(s=(lcg_a*s+lcg_c)%lcg_m)/lcg_m}();function step(){tick(),event.call("tick",simulation),alpha<alphaMin&&(stepper.stop(),event.call("end",simulation))}function tick(iterations){var i,node,n=nodes.length;void 0===iterations&&(iterations=1);for(var k=0;k<iterations;++k)for(alpha+=(alphaTarget-alpha)*alphaDecay,forces.forEach((function(force){force(alpha)})),i=0;i<n;++i)null==(node=nodes[i]).fx?node.x+=node.vx*=velocityDecay:(node.x=node.fx,node.vx=0),nDim>1&&(null==node.fy?node.y+=node.vy*=velocityDecay:(node.y=node.fy,node.vy=0)),nDim>2&&(null==node.fz?node.z+=node.vz*=velocityDecay:(node.z=node.fz,node.vz=0));return simulation}function initializeNodes(){for(var node,i=0,n=nodes.length;i<n;++i){if((node=nodes[i]).index=i,null!=node.fx&&(node.x=node.fx),null!=node.fy&&(node.y=node.fy),null!=node.fz&&(node.z=node.fz),isNaN(node.x)||nDim>1&&isNaN(node.y)||nDim>2&&isNaN(node.z)){var radius=10*(nDim>2?Math.cbrt(.5+i):nDim>1?Math.sqrt(.5+i):i),rollAngle=i*initialAngleRoll,yawAngle=i*initialAngleYaw;1===nDim?node.x=radius:2===nDim?(node.x=radius*Math.cos(rollAngle),node.y=radius*Math.sin(rollAngle)):(node.x=radius*Math.sin(rollAngle)*Math.cos(yawAngle),node.y=radius*Math.cos(rollAngle),node.z=radius*Math.sin(rollAngle)*Math.sin(yawAngle))}(isNaN(node.vx)||nDim>1&&isNaN(node.vy)||nDim>2&&isNaN(node.vz))&&(node.vx=0,nDim>1&&(node.vy=0),nDim>2&&(node.vz=0))}}function initializeForce(force){return force.initialize&&force.initialize(nodes,random,nDim),force}return null==nodes&&(nodes=[]),initializeNodes(),simulation={tick,restart:function(){return stepper.restart(step),simulation},stop:function(){return stepper.stop(),simulation},numDimensions:function(_){return arguments.length?(nDim=Math.min(3,Math.max(1,Math.round(_))),forces.forEach(initializeForce),simulation):nDim},nodes:function(_){return arguments.length?(nodes=_,initializeNodes(),forces.forEach(initializeForce),simulation):nodes},alpha:function(_){return arguments.length?(alpha=+_,simulation):alpha},alphaMin:function(_){return arguments.length?(alphaMin=+_,simulation):alphaMin},alphaDecay:function(_){return arguments.length?(alphaDecay=+_,simulation):+alphaDecay},alphaTarget:function(_){return arguments.length?(alphaTarget=+_,simulation):alphaTarget},velocityDecay:function(_){return arguments.length?(velocityDecay=1-_,simulation):1-velocityDecay},randomSource:function(_){return arguments.length?(random=_,forces.forEach(initializeForce),simulation):random},force:function(name,_){return arguments.length>1?(null==_?forces.delete(name):forces.set(name,initializeForce(_)),simulation):forces.get(name)},find:function(){var dx,dy,dz,d2,node,closest,args=Array.prototype.slice.call(arguments),x=args.shift()||0,y=(nDim>1?args.shift():null)||0,z=(nDim>2?args.shift():null)||0,radius=args.shift()||1/0,i=0,n=nodes.length;for(radius*=radius,i=0;i<n;++i)(d2=(dx=x-(node=nodes[i]).x)*dx+(dy=y-(node.y||0))*dy+(dz=z-(node.z||0))*dz)<radius&&(closest=node,radius=d2);return closest},on:function(name,_){return arguments.length>1?(event.on(name,_),simulation):event.on(name)}}}function d3_force_3d_src_constant(x){return function(){return x}}function jiggle(random){return 1e-6*(random()-.5)}function link_index(d){return d.index}function link_find(nodeById,nodeId){var node=nodeById.get(nodeId);if(!node)throw new Error("node not found: "+nodeId);return node}function src_link(links){var strengths,distances,nodes,nDim,count,bias,random,id=link_index,strength=function defaultStrength(link){return 1/Math.min(count[link.source.index],count[link.target.index])},distance=d3_force_3d_src_constant(30),iterations=1;function force(alpha){for(var k=0,n=links.length;k<iterations;++k)for(var link,source,target,l,b,i=0,x=0,y=0,z=0;i<n;++i)source=(link=links[i]).source,x=(target=link.target).x+target.vx-source.x-source.vx||jiggle(random),nDim>1&&(y=target.y+target.vy-source.y-source.vy||jiggle(random)),nDim>2&&(z=target.z+target.vz-source.z-source.vz||jiggle(random)),x*=l=((l=Math.sqrt(x*x+y*y+z*z))-distances[i])/l*alpha*strengths[i],y*=l,z*=l,target.vx-=x*(b=bias[i]),nDim>1&&(target.vy-=y*b),nDim>2&&(target.vz-=z*b),source.vx+=x*(b=1-b),nDim>1&&(source.vy+=y*b),nDim>2&&(source.vz+=z*b)}function initialize(){if(nodes){var i,link,n=nodes.length,m=links.length,nodeById=new Map(nodes.map(((d,i)=>[id(d,i,nodes),d])));for(i=0,count=new Array(n);i<m;++i)(link=links[i]).index=i,"object"!=typeof link.source&&(link.source=link_find(nodeById,link.source)),"object"!=typeof link.target&&(link.target=link_find(nodeById,link.target)),count[link.source.index]=(count[link.source.index]||0)+1,count[link.target.index]=(count[link.target.index]||0)+1;for(i=0,bias=new Array(m);i<m;++i)link=links[i],bias[i]=count[link.source.index]/(count[link.source.index]+count[link.target.index]);strengths=new Array(m),initializeStrength(),distances=new Array(m),initializeDistance()}}function initializeStrength(){if(nodes)for(var i=0,n=links.length;i<n;++i)strengths[i]=+strength(links[i],i,links)}function initializeDistance(){if(nodes)for(var i=0,n=links.length;i<n;++i)distances[i]=+distance(links[i],i,links)}return null==links&&(links=[]),force.initialize=function(_nodes,...args){nodes=_nodes,random=args.find((arg=>"function"==typeof arg))||Math.random,nDim=args.find((arg=>[1,2,3].includes(arg)))||2,initialize()},force.links=function(_){return arguments.length?(links=_,initialize(),force):links},force.id=function(_){return arguments.length?(id=_,force):id},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:d3_force_3d_src_constant(+_),initializeStrength(),force):strength},force.distance=function(_){return arguments.length?(distance="function"==typeof _?_:d3_force_3d_src_constant(+_),initializeDistance(),force):distance},force}function add_add(tree,x,d){if(isNaN(x))return tree;var parent,xm,xp,right,i,j,node=tree._root,leaf={data:d},x0=tree._x0,x1=tree._x1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,parent=node,!(node=node[i=+right]))return parent[i]=leaf,tree;if(x===(xp=+tree._x.call(null,node.data)))return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(2):tree._root=new Array(2),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm}while((i=+right)==(j=+(xp>=xm)));return parent[j]=node,parent[i]=leaf,tree}function half(node,x0,x1){this.node=node,this.x0=x0,this.x1=x1}function defaultX(d){return d[0]}function binarytree(nodes,x){var tree=new Binarytree(null==x?defaultX:x,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Binarytree(x,x0,x1){this._x=x,this._x0=x0,this._x1=x1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}var treeProto=binarytree.prototype=Binarytree.prototype;function src_add_add(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function quad(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1}function x_defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?x_defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function quadtree_leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}treeProto.copy=function(){var nodes,child,copy=new Binarytree(this._x,this._x0,this._x1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(2)}];node=nodes.pop();)for(var i=0;i<2;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(2)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=function src_add(d){const x=+this._x.call(null,d);return add_add(this.cover(x),x,d)},treeProto.addAll=function addAll(data){Array.isArray(data)||(data=Array.from(data));const n=data.length,xz=new Float64Array(n);let x0=1/0,x1=-1/0;for(let x,i=0;i<n;++i)isNaN(x=+this._x.call(null,data[i]))||(xz[i]=x,x<x0&&(x0=x),x>x1&&(x1=x));if(x0>x1)return this;this.cover(x0).cover(x1);for(let i=0;i<n;++i)add_add(this,xz[i],data[i]);return this},treeProto.cover=function cover(x){if(isNaN(x=+x))return this;var x0=this._x0,x1=this._x1;if(isNaN(x0))x1=(x0=Math.floor(x))+1;else{for(var parent,i,z=x1-x0||1,node=this._root;x0>x||x>=x1;)switch(i=+(x<x0),(parent=new Array(2))[i]=node,node=parent,z*=2,i){case 0:x1=x0+z;break;case 1:x0=x1-z}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._x1=x1,this},treeProto.data=function src_data(){var data=[];return this.visit((function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)})),data},treeProto.extent=function extent(_){return arguments.length?this.cover(+_[0][0]).cover(+_[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]},treeProto.find=function src_find(x,radius){var data,x1,x2,q,i,x0=this._x0,x3=this._x1,halves=[],node=this._root;for(node&&halves.push(new half(node,x0,x3)),null==radius?radius=1/0:(x0=x-radius,x3=x+radius);q=halves.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(x2=q.x1)<x0))if(node.length){var xm=(x1+x2)/2;halves.push(new half(node[1],xm,x2),new half(node[0],x1,xm)),(i=+(x>=xm))&&(q=halves[halves.length-1],halves[halves.length-1]=halves[halves.length-1-i],halves[halves.length-1-i]=q)}else{var d=Math.abs(x-+this._x.call(null,node.data));d<radius&&(radius=d,x0=x-d,x3=x+d,data=node.data)}return data},treeProto.remove=function src_remove(d){if(isNaN(x=+this._x.call(null,d)))return this;var parent,retainer,previous,next,x,xm,right,i,j,node=this._root,x0=this._x0,x1=this._x1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,parent=node,!(node=node[i=+right]))return this;if(!node.length)break;parent[i+1&1]&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1])&&node===(parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},treeProto.removeAll=function remove_removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},treeProto.root=function src_root(){return this._root},treeProto.size=function src_size(){var size=0;return this.visit((function(node){if(!node.length)do{++size}while(node=node.next)})),size},treeProto.visit=function visit(callback){var q,child,x0,x1,halves=[],node=this._root;for(node&&halves.push(new half(node,this._x0,this._x1));q=halves.pop();)if(!callback(node=q.node,x0=q.x0,x1=q.x1)&&node.length){var xm=(x0+x1)/2;(child=node[1])&&halves.push(new half(child,xm,x1)),(child=node[0])&&halves.push(new half(child,x0,xm))}return this},treeProto.visitAfter=function visitAfter(callback){var q,halves=[],next=[];for(this._root&&halves.push(new half(this._root,this._x0,this._x1));q=halves.pop();){var node=q.node;if(node.length){var child,x0=q.x0,x1=q.x1,xm=(x0+x1)/2;(child=node[0])&&halves.push(new half(child,x0,xm)),(child=node[1])&&halves.push(new half(child,xm,x1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.x1);return this},treeProto.x=function src_x(_){return arguments.length?(this._x=_,this):this._x};var quadtree_treeProto=quadtree.prototype=Quadtree.prototype;function d3_octree_src_add_add(tree,x,y,z,d){if(isNaN(x)||isNaN(y)||isNaN(z))return tree;var parent,xm,ym,zm,xp,yp,zp,right,bottom,deep,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,z0=tree._z0,x1=tree._x1,y1=tree._y1,z1=tree._z1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm,parent=node,!(node=node[i=deep<<2|bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),zp=+tree._z.call(null,node.data),x===xp&&y===yp&&z===zp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(8):tree._root=new Array(8),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm}while((i=deep<<2|bottom<<1|right)==(j=(zp>=zm)<<2|(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function octant(node,x0,y0,z0,x1,y1,z1){this.node=node,this.x0=x0,this.y0=y0,this.z0=z0,this.x1=x1,this.y1=y1,this.z1=z1}function src_x_defaultX(d){return d[0]}function y_defaultY(d){return d[1]}function defaultZ(d){return d[2]}function octree(nodes,x,y,z){var tree=new Octree(null==x?src_x_defaultX:x,null==y?y_defaultY:y,null==z?defaultZ:z,NaN,NaN,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Octree(x,y,z,x0,y0,z0,x1,y1,z1){this._x=x,this._y=y,this._z=z,this._x0=x0,this._y0=y0,this._z0=z0,this._x1=x1,this._y1=y1,this._z1=z1,this._root=void 0}function octree_leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}quadtree_treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=quadtree_leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=quadtree_leaf_copy(child));return copy},quadtree_treeProto.add=function d3_quadtree_src_add(d){const x=+this._x.call(null,d),y=+this._y.call(null,d);return src_add_add(this.cover(x,y),x,y,d)},quadtree_treeProto.addAll=function add_addAll(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));if(x0>x1||y0>y1)return this;for(this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)src_add_add(this,xz[i],yz[i],data[i]);return this},quadtree_treeProto.cover=function src_cover(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{for(var parent,i,z=x1-x0||1,node=this._root;x0>x||x>=x1||y0>y||y>=y1;)switch(i=(y<y0)<<1|x<x0,(parent=new Array(4))[i]=node,node=parent,z*=2,i){case 0:x1=x0+z,y1=y0+z;break;case 1:x0=x1-z,y1=y0+z;break;case 2:x1=x0+z,y0=y1-z;break;case 3:x0=x1-z,y0=y1-z}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},quadtree_treeProto.data=function d3_quadtree_src_data(){var data=[];return this.visit((function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)})),data},quadtree_treeProto.extent=function src_extent(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},quadtree_treeProto.find=function d3_quadtree_src_find(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new quad(node[3],xm,ym,x2,y2),new quad(node[2],x1,ym,xm,y2),new quad(node[1],xm,y1,x2,ym),new quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},quadtree_treeProto.remove=function d3_quadtree_src_remove(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},quadtree_treeProto.removeAll=function src_remove_removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},quadtree_treeProto.root=function d3_quadtree_src_root(){return this._root},quadtree_treeProto.size=function d3_quadtree_src_size(){var size=0;return this.visit((function(node){if(!node.length)do{++size}while(node=node.next)})),size},quadtree_treeProto.visit=function src_visit(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new quad(child,x0,y0,xm,ym))}return this},quadtree_treeProto.visitAfter=function src_visitAfter(callback){var q,quads=[],next=[];for(this._root&&quads.push(new quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},quadtree_treeProto.x=function d3_quadtree_src_x(_){return arguments.length?(this._x=_,this):this._x},quadtree_treeProto.y=function src_y(_){return arguments.length?(this._y=_,this):this._y};var octree_treeProto=octree.prototype=Octree.prototype;function manyBody(){var nodes,nDim,node,random,alpha,strengths,strength=d3_force_3d_src_constant(-30),distanceMin2=1,distanceMax2=1/0,theta2=.81;function force(_){var i,n=nodes.length,tree=(1===nDim?binarytree(nodes,simulation_x):2===nDim?quadtree(nodes,simulation_x,simulation_y):3===nDim?octree(nodes,simulation_x,simulation_y,simulation_z):null).visitAfter(accumulate);for(alpha=_,i=0;i<n;++i)node=nodes[i],tree.visit(apply)}function initialize(){if(nodes){var i,node,n=nodes.length;for(strengths=new Array(n),i=0;i<n;++i)node=nodes[i],strengths[node.index]=+strength(node,i,nodes)}}function accumulate(treeNode){var q,c,x,y,z,i,strength=0,weight=0,numChildren=treeNode.length;if(numChildren){for(x=y=z=i=0;i<numChildren;++i)(q=treeNode[i])&&(c=Math.abs(q.value))&&(strength+=q.value,weight+=c,x+=c*(q.x||0),y+=c*(q.y||0),z+=c*(q.z||0));strength*=Math.sqrt(4/numChildren),treeNode.x=x/weight,nDim>1&&(treeNode.y=y/weight),nDim>2&&(treeNode.z=z/weight)}else{(q=treeNode).x=q.data.x,nDim>1&&(q.y=q.data.y),nDim>2&&(q.z=q.data.z);do{strength+=strengths[q.data.index]}while(q=q.next)}treeNode.value=strength}function apply(treeNode,x1,arg1,arg2,arg3){if(!treeNode.value)return!0;var x2=[arg1,arg2,arg3][nDim-1],x=treeNode.x-node.x,y=nDim>1?treeNode.y-node.y:0,z=nDim>2?treeNode.z-node.z:0,w=x2-x1,l=x*x+y*y+z*z;if(w*w/theta2<l)return l<distanceMax2&&(0===x&&(l+=(x=jiggle(random))*x),nDim>1&&0===y&&(l+=(y=jiggle(random))*y),nDim>2&&0===z&&(l+=(z=jiggle(random))*z),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)),node.vx+=x*treeNode.value*alpha/l,nDim>1&&(node.vy+=y*treeNode.value*alpha/l),nDim>2&&(node.vz+=z*treeNode.value*alpha/l)),!0;if(!(treeNode.length||l>=distanceMax2)){(treeNode.data!==node||treeNode.next)&&(0===x&&(l+=(x=jiggle(random))*x),nDim>1&&0===y&&(l+=(y=jiggle(random))*y),nDim>2&&0===z&&(l+=(z=jiggle(random))*z),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)));do{treeNode.data!==node&&(w=strengths[treeNode.data.index]*alpha/l,node.vx+=x*w,nDim>1&&(node.vy+=y*w),nDim>2&&(node.vz+=z*w))}while(treeNode=treeNode.next)}}return force.initialize=function(_nodes,...args){nodes=_nodes,random=args.find((arg=>"function"==typeof arg))||Math.random,nDim=args.find((arg=>[1,2,3].includes(arg)))||2,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:d3_force_3d_src_constant(+_),initialize(),force):strength},force.distanceMin=function(_){return arguments.length?(distanceMin2=_*_,force):Math.sqrt(distanceMin2)},force.distanceMax=function(_){return arguments.length?(distanceMax2=_*_,force):Math.sqrt(distanceMax2)},force.theta=function(_){return arguments.length?(theta2=_*_,force):Math.sqrt(theta2)},force}function center(x,y,z){var nodes,strength=1;function force(){var i,node,n=nodes.length,sx=0,sy=0,sz=0;for(i=0;i<n;++i)sx+=(node=nodes[i]).x||0,sy+=node.y||0,sz+=node.z||0;for(sx=(sx/n-x)*strength,sy=(sy/n-y)*strength,sz=(sz/n-z)*strength,i=0;i<n;++i)node=nodes[i],sx&&(node.x-=sx),sy&&(node.y-=sy),sz&&(node.z-=sz)}return null==x&&(x=0),null==y&&(y=0),null==z&&(z=0),force.initialize=function(_){nodes=_},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force.z=function(_){return arguments.length?(z=+_,force):z},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force}octree_treeProto.copy=function(){var nodes,child,copy=new Octree(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=octree_leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(8)}];node=nodes.pop();)for(var i=0;i<8;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(8)}):node.target[i]=octree_leaf_copy(child));return copy},octree_treeProto.add=function d3_octree_src_add(d){const x=+this._x.call(null,d),y=+this._y.call(null,d),z=+this._z.call(null,d);return d3_octree_src_add_add(this.cover(x,y,z),x,y,z,d)},octree_treeProto.addAll=function src_add_addAll(data){Array.isArray(data)||(data=Array.from(data));const n=data.length,xz=new Float64Array(n),yz=new Float64Array(n),zz=new Float64Array(n);let x0=1/0,y0=1/0,z0=1/0,x1=-1/0,y1=-1/0,z1=-1/0;for(let d,x,y,z,i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||isNaN(z=+this._z.call(null,d))||(xz[i]=x,yz[i]=y,zz[i]=z,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y),z<z0&&(z0=z),z>z1&&(z1=z));if(x0>x1||y0>y1||z0>z1)return this;this.cover(x0,y0,z0).cover(x1,y1,z1);for(let i=0;i<n;++i)d3_octree_src_add_add(this,xz[i],yz[i],zz[i],data[i]);return this},octree_treeProto.cover=function d3_octree_src_cover(x,y,z){if(isNaN(x=+x)||isNaN(y=+y)||isNaN(z=+z))return this;var x0=this._x0,y0=this._y0,z0=this._z0,x1=this._x1,y1=this._y1,z1=this._z1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1,z1=(z0=Math.floor(z))+1;else{for(var parent,i,t=x1-x0||1,node=this._root;x0>x||x>=x1||y0>y||y>=y1||z0>z||z>=z1;)switch(i=(z<z0)<<2|(y<y0)<<1|x<x0,(parent=new Array(8))[i]=node,node=parent,t*=2,i){case 0:x1=x0+t,y1=y0+t,z1=z0+t;break;case 1:x0=x1-t,y1=y0+t,z1=z0+t;break;case 2:x1=x0+t,y0=y1-t,z1=z0+t;break;case 3:x0=x1-t,y0=y1-t,z1=z0+t;break;case 4:x1=x0+t,y1=y0+t,z0=z1-t;break;case 5:x0=x1-t,y1=y0+t,z0=z1-t;break;case 6:x1=x0+t,y0=y1-t,z0=z1-t;break;case 7:x0=x1-t,y0=y1-t,z0=z1-t}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._z0=z0,this._x1=x1,this._y1=y1,this._z1=z1,this},octree_treeProto.data=function d3_octree_src_data(){var data=[];return this.visit((function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)})),data},octree_treeProto.extent=function d3_octree_src_extent(_){return arguments.length?this.cover(+_[0][0],+_[0][1],+_[0][2]).cover(+_[1][0],+_[1][1],+_[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},octree_treeProto.find=function d3_octree_src_find(x,y,z,radius){var data,x1,y1,z1,x2,y2,z2,q,i,x0=this._x0,y0=this._y0,z0=this._z0,x3=this._x1,y3=this._y1,z3=this._z1,octs=[],node=this._root;for(node&&octs.push(new octant(node,x0,y0,z0,x3,y3,z3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,z0=z-radius,x3=x+radius,y3=y+radius,z3=z+radius,radius*=radius);q=octs.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(z1=q.z0)>z3||(x2=q.x1)<x0||(y2=q.y1)<y0||(z2=q.z1)<z0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2,zm=(z1+z2)/2;octs.push(new octant(node[7],xm,ym,zm,x2,y2,z2),new octant(node[6],x1,ym,zm,xm,y2,z2),new octant(node[5],xm,y1,zm,x2,ym,z2),new octant(node[4],x1,y1,zm,xm,ym,z2),new octant(node[3],xm,ym,z1,x2,y2,zm),new octant(node[2],x1,ym,z1,xm,y2,zm),new octant(node[1],xm,y1,z1,x2,ym,zm),new octant(node[0],x1,y1,z1,xm,ym,zm)),(i=(z>=zm)<<2|(y>=ym)<<1|x>=xm)&&(q=octs[octs.length-1],octs[octs.length-1]=octs[octs.length-1-i],octs[octs.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),dz=z-+this._z.call(null,node.data),d2=dx*dx+dy*dy+dz*dz;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,z0=z-d,x3=x+d,y3=y+d,z3=z+d,data=node.data}}return data},octree_treeProto.remove=function d3_octree_src_remove(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d))||isNaN(z=+this._z.call(null,d)))return this;var parent,retainer,previous,next,x,y,z,xm,ym,zm,right,bottom,deep,i,j,node=this._root,x0=this._x0,y0=this._y0,z0=this._z0,x1=this._x1,y1=this._y1,z1=this._z1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm,parent=node,!(node=node[i=deep<<2|bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&7]||parent[i+2&7]||parent[i+3&7]||parent[i+4&7]||parent[i+5&7]||parent[i+6&7]||parent[i+7&7])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3]||parent[4]||parent[5]||parent[6]||parent[7])&&node===(parent[7]||parent[6]||parent[5]||parent[4]||parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},octree_treeProto.removeAll=function d3_octree_src_remove_removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},octree_treeProto.root=function d3_octree_src_root(){return this._root},octree_treeProto.size=function d3_octree_src_size(){var size=0;return this.visit((function(node){if(!node.length)do{++size}while(node=node.next)})),size},octree_treeProto.visit=function d3_octree_src_visit(callback){var q,child,x0,y0,z0,x1,y1,z1,octs=[],node=this._root;for(node&&octs.push(new octant(node,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));q=octs.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,z0=q.z0,x1=q.x1,y1=q.y1,z1=q.z1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2,zm=(z0+z1)/2;(child=node[7])&&octs.push(new octant(child,xm,ym,zm,x1,y1,z1)),(child=node[6])&&octs.push(new octant(child,x0,ym,zm,xm,y1,z1)),(child=node[5])&&octs.push(new octant(child,xm,y0,zm,x1,ym,z1)),(child=node[4])&&octs.push(new octant(child,x0,y0,zm,xm,ym,z1)),(child=node[3])&&octs.push(new octant(child,xm,ym,z0,x1,y1,zm)),(child=node[2])&&octs.push(new octant(child,x0,ym,z0,xm,y1,zm)),(child=node[1])&&octs.push(new octant(child,xm,y0,z0,x1,ym,zm)),(child=node[0])&&octs.push(new octant(child,x0,y0,z0,xm,ym,zm))}return this},octree_treeProto.visitAfter=function d3_octree_src_visitAfter(callback){var q,octs=[],next=[];for(this._root&&octs.push(new octant(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));q=octs.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,z0=q.z0,x1=q.x1,y1=q.y1,z1=q.z1,xm=(x0+x1)/2,ym=(y0+y1)/2,zm=(z0+z1)/2;(child=node[0])&&octs.push(new octant(child,x0,y0,z0,xm,ym,zm)),(child=node[1])&&octs.push(new octant(child,xm,y0,z0,x1,ym,zm)),(child=node[2])&&octs.push(new octant(child,x0,ym,z0,xm,y1,zm)),(child=node[3])&&octs.push(new octant(child,xm,ym,z0,x1,y1,zm)),(child=node[4])&&octs.push(new octant(child,x0,y0,zm,xm,ym,z1)),(child=node[5])&&octs.push(new octant(child,xm,y0,zm,x1,ym,z1)),(child=node[6])&&octs.push(new octant(child,x0,ym,zm,xm,y1,z1)),(child=node[7])&&octs.push(new octant(child,xm,ym,zm,x1,y1,z1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.z0,q.x1,q.y1,q.z1);return this},octree_treeProto.x=function d3_octree_src_x(_){return arguments.length?(this._x=_,this):this._x},octree_treeProto.y=function d3_octree_src_y(_){return arguments.length?(this._y=_,this):this._y},octree_treeProto.z=function src_z(_){return arguments.length?(this._z=_,this):this._z};const{abs,cos,sin,acos,atan2,sqrt,pow}=Math;function crt(v){return v<0?-pow(-v,1/3):pow(v,1/3)}const pi=Math.PI,tau=2*pi,quart=pi/2,nMax=Number.MAX_SAFE_INTEGER||9007199254740991,nMin=Number.MIN_SAFE_INTEGER||-9007199254740991,ZERO={x:0,y:0,z:0},utils={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,derivativeFn){const d=derivativeFn(t);let l=d.x*d.x+d.y*d.y;return void 0!==d.z&&(l+=d.z*d.z),sqrt(l)},compute:function(t,points,_3d){if(0===t)return points[0].t=0,points[0];const order=points.length-1;if(1===t)return points[order].t=1,points[order];const mt=1-t;let p=points;if(0===order)return points[0].t=t,points[0];if(1===order){const ret={x:mt*p[0].x+t*p[1].x,y:mt*p[0].y+t*p[1].y,t};return _3d&&(ret.z=mt*p[0].z+t*p[1].z),ret}if(order<4){let a,b,c,mt2=mt*mt,t2=t*t,d=0;2===order?(p=[p[0],p[1],p[2],ZERO],a=mt2,b=mt*t*2,c=t2):3===order&&(a=mt2*mt,b=mt2*t*3,c=mt*t2*3,d=t*t2);const ret={x:a*p[0].x+b*p[1].x+c*p[2].x+d*p[3].x,y:a*p[0].y+b*p[1].y+c*p[2].y+d*p[3].y,t};return _3d&&(ret.z=a*p[0].z+b*p[1].z+c*p[2].z+d*p[3].z),ret}const dCpts=JSON.parse(JSON.stringify(points));for(;dCpts.length>1;){for(let i=0;i<dCpts.length-1;i++)dCpts[i]={x:dCpts[i].x+(dCpts[i+1].x-dCpts[i].x)*t,y:dCpts[i].y+(dCpts[i+1].y-dCpts[i].y)*t},void 0!==dCpts[i].z&&(dCpts[i].z=dCpts[i].z+(dCpts[i+1].z-dCpts[i].z)*t);dCpts.splice(dCpts.length-1,1)}return dCpts[0].t=t,dCpts[0]},computeWithRatios:function(t,points,ratios,_3d){const mt=1-t,r=ratios,p=points;let d,f1=r[0],f2=r[1],f3=r[2],f4=r[3];return f1*=mt,f2*=t,2===p.length?(d=f1+f2,{x:(f1*p[0].x+f2*p[1].x)/d,y:(f1*p[0].y+f2*p[1].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z)/d,t}):(f1*=mt,f2*=2*mt,f3*=t*t,3===p.length?(d=f1+f2+f3,{x:(f1*p[0].x+f2*p[1].x+f3*p[2].x)/d,y:(f1*p[0].y+f2*p[1].y+f3*p[2].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z+f3*p[2].z)/d,t}):(f1*=mt,f2*=1.5*mt,f3*=3*mt,f4*=t*t*t,4===p.length?(d=f1+f2+f3+f4,{x:(f1*p[0].x+f2*p[1].x+f3*p[2].x+f4*p[3].x)/d,y:(f1*p[0].y+f2*p[1].y+f3*p[2].y+f4*p[3].y)/d,z:!!_3d&&(f1*p[0].z+f2*p[1].z+f3*p[2].z+f4*p[3].z)/d,t}):void 0))},derive:function(points,_3d){const dpoints=[];for(let p=points,d=p.length,c=d-1;d>1;d--,c--){const list=[];for(let dpt,j=0;j<c;j++)dpt={x:c*(p[j+1].x-p[j].x),y:c*(p[j+1].y-p[j].y)},_3d&&(dpt.z=c*(p[j+1].z-p[j].z)),list.push(dpt);dpoints.push(list),p=list}return dpoints},between:function(v,m,M){return m<=v&&v<=M||utils.approximately(v,m)||utils.approximately(v,M)},approximately:function(a,b,precision){return abs(a-b)<=(precision||1e-6)},length:function(derivativeFn){const len=utils.Tvalues.length;let sum=0;for(let t,i=0;i<len;i++)t=.5*utils.Tvalues[i]+.5,sum+=utils.Cvalues[i]*utils.arcfn(t,derivativeFn);return.5*sum},map:function(v,ds,de,ts,te){return ts+(te-ts)*((v-ds)/(de-ds))},lerp:function(r,v1,v2){const ret={x:v1.x+r*(v2.x-v1.x),y:v1.y+r*(v2.y-v1.y)};return void 0!==v1.z&&void 0!==v2.z&&(ret.z=v1.z+r*(v2.z-v1.z)),ret},pointToString:function(p){let s=p.x+"/"+p.y;return void 0!==p.z&&(s+="/"+p.z),s},pointsToString:function(points){return"["+points.map(utils.pointToString).join(", ")+"]"},copy:function(obj){return JSON.parse(JSON.stringify(obj))},angle:function(o,v1,v2){const dx1=v1.x-o.x,dy1=v1.y-o.y,dx2=v2.x-o.x,dy2=v2.y-o.y;return atan2(dx1*dy2-dy1*dx2,dx1*dx2+dy1*dy2)},round:function(v,d){const s=""+v,pos=s.indexOf(".");return parseFloat(s.substring(0,pos+1+d))},dist:function(p1,p2){const dx=p1.x-p2.x,dy=p1.y-p2.y;return sqrt(dx*dx+dy*dy)},closest:function(LUT,point){let mpos,d,mdist=pow(2,63);return LUT.forEach((function(p,idx){d=utils.dist(point,p),d<mdist&&(mdist=d,mpos=idx)})),{mdist,mpos}},abcratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const bottom=pow(t,n)+pow(1-t,n);return abs((bottom-1)/bottom)},projectionratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const top=pow(1-t,n);return top/(pow(t,n)+top)},lli8:function(x1,y1,x2,y2,x3,y3,x4,y4){const d=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);return 0!=d&&{x:((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4))/d,y:((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4))/d}},lli4:function(p1,p2,p3,p4){const x1=p1.x,y1=p1.y,x2=p2.x,y2=p2.y,x3=p3.x,y3=p3.y,x4=p4.x,y4=p4.y;return utils.lli8(x1,y1,x2,y2,x3,y3,x4,y4)},lli:function(v1,v2){return utils.lli4(v1,v1.c,v2,v2.c)},makeline:function(p1,p2){return new Bezier(p1.x,p1.y,(p1.x+p2.x)/2,(p1.y+p2.y)/2,p2.x,p2.y)},findbbox:function(sections){let mx=nMax,my=nMax,MX=nMin,MY=nMin;return sections.forEach((function(s){const bbox=s.bbox();mx>bbox.x.min&&(mx=bbox.x.min),my>bbox.y.min&&(my=bbox.y.min),MX<bbox.x.max&&(MX=bbox.x.max),MY<bbox.y.max&&(MY=bbox.y.max)})),{x:{min:mx,mid:(mx+MX)/2,max:MX,size:MX-mx},y:{min:my,mid:(my+MY)/2,max:MY,size:MY-my}}},shapeintersections:function(s1,bbox1,s2,bbox2,curveIntersectionThreshold){if(!utils.bboxoverlap(bbox1,bbox2))return[];const intersections=[],a1=[s1.startcap,s1.forward,s1.back,s1.endcap],a2=[s2.startcap,s2.forward,s2.back,s2.endcap];return a1.forEach((function(l1){l1.virtual||a2.forEach((function(l2){if(l2.virtual)return;const iss=l1.intersects(l2,curveIntersectionThreshold);iss.length>0&&(iss.c1=l1,iss.c2=l2,iss.s1=s1,iss.s2=s2,intersections.push(iss))}))})),intersections},makeshape:function(forward,back,curveIntersectionThreshold){const bpl=back.points.length,fpl=forward.points.length,start=utils.makeline(back.points[bpl-1],forward.points[0]),end=utils.makeline(forward.points[fpl-1],back.points[0]),shape={startcap:start,forward,back,endcap:end,bbox:utils.findbbox([start,forward,back,end]),intersections:function(s2){return utils.shapeintersections(shape,shape.bbox,s2,s2.bbox,curveIntersectionThreshold)}};return shape},getminmax:function(curve,d,list){if(!list)return{min:0,max:0};let t,c,min=nMax,max=nMin;-1===list.indexOf(0)&&(list=[0].concat(list)),-1===list.indexOf(1)&&list.push(1);for(let i=0,len=list.length;i<len;i++)t=list[i],c=curve.get(t),c[d]<min&&(min=c[d]),c[d]>max&&(max=c[d]);return{min,mid:(min+max)/2,max,size:max-min}},align:function(points,line){const tx=line.p1.x,ty=line.p1.y,a=-atan2(line.p2.y-ty,line.p2.x-tx);return points.map((function(v){return{x:(v.x-tx)*cos(a)-(v.y-ty)*sin(a),y:(v.x-tx)*sin(a)+(v.y-ty)*cos(a)}}))},roots:function(points,line){line=line||{p1:{x:0,y:0},p2:{x:1,y:0}};const order=points.length-1,aligned=utils.align(points,line),reduce=function(t){return 0<=t&&t<=1};if(2===order){const a=aligned[0].y,b=aligned[1].y,c=aligned[2].y,d=a-2*b+c;if(0!==d){const m1=-sqrt(b*b-a*c),m2=-a+b;return[-(m1+m2)/d,-(-m1+m2)/d].filter(reduce)}return b!==c&&0===d?[(2*b-c)/(2*b-2*c)].filter(reduce):[]}const pa=aligned[0].y,pb=aligned[1].y,pc=aligned[2].y;let d=3*pb-pa-3*pc+aligned[3].y,a=3*pa-6*pb+3*pc,b=-3*pa+3*pb,c=pa;if(utils.approximately(d,0)){if(utils.approximately(a,0))return utils.approximately(b,0)?[]:[-c/b].filter(reduce);const q=sqrt(b*b-4*a*c),a2=2*a;return[(q-b)/a2,(-b-q)/a2].filter(reduce)}a/=d,b/=d,c/=d;const p=(3*b-a*a)/3,p3=p/3,q=(2*a*a*a-9*a*b+27*c)/27,q2=q/2,discriminant=q2*q2+p3*p3*p3;let u1,v1,x1,x2,x3;if(discriminant<0){const mp3=-p/3,r=sqrt(mp3*mp3*mp3),t=-q/(2*r),phi=acos(t<-1?-1:t>1?1:t),t1=2*crt(r);return x1=t1*cos(phi/3)-a/3,x2=t1*cos((phi+tau)/3)-a/3,x3=t1*cos((phi+2*tau)/3)-a/3,[x1,x2,x3].filter(reduce)}if(0===discriminant)return u1=q2<0?crt(-q2):-crt(q2),x1=2*u1-a/3,x2=-u1-a/3,[x1,x2].filter(reduce);{const sd=sqrt(discriminant);return u1=crt(-q2+sd),v1=crt(q2+sd),[u1-v1-a/3].filter(reduce)}},droots:function(p){if(3===p.length){const a=p[0],b=p[1],c=p[2],d=a-2*b+c;if(0!==d){const m1=-sqrt(b*b-a*c),m2=-a+b;return[-(m1+m2)/d,-(-m1+m2)/d]}return b!==c&&0===d?[(2*b-c)/(2*(b-c))]:[]}if(2===p.length){const a=p[0],b=p[1];return a!==b?[a/(a-b)]:[]}return[]},curvature:function(t,d1,d2,_3d,kOnly){let num,dnm,adk,dk,k=0,r=0;const d=utils.compute(t,d1),dd=utils.compute(t,d2),qdsum=d.x*d.x+d.y*d.y;if(_3d?(num=sqrt(pow(d.y*dd.z-dd.y*d.z,2)+pow(d.z*dd.x-dd.z*d.x,2)+pow(d.x*dd.y-dd.x*d.y,2)),dnm=pow(qdsum+d.z*d.z,1.5)):(num=d.x*dd.y-d.y*dd.x,dnm=pow(qdsum,1.5)),0===num||0===dnm)return{k:0,r:0};if(k=num/dnm,r=dnm/num,!kOnly){const pk=utils.curvature(t-.001,d1,d2,_3d,!0).k,nk=utils.curvature(t+.001,d1,d2,_3d,!0).k;dk=(nk-k+(k-pk))/2,adk=(abs(nk-k)+abs(k-pk))/2}return{k,r,dk,adk}},inflections:function(points){if(points.length<4)return[];const p=utils.align(points,{p1:points[0],p2:points.slice(-1)[0]}),a=p[2].x*p[1].y,b=p[3].x*p[1].y,c=p[1].x*p[2].y,v1=18*(-3*a+2*b+3*c-p[3].x*p[2].y),v2=18*(3*a-b-3*c),v3=18*(c-a);if(utils.approximately(v1,0)){if(!utils.approximately(v2,0)){let t=-v3/v2;if(0<=t&&t<=1)return[t]}return[]}const d2=2*v1;if(utils.approximately(d2,0))return[];const trm=v2*v2-4*v1*v3;if(trm<0)return[];const sq=Math.sqrt(trm);return[(sq-v2)/d2,-(v2+sq)/d2].filter((function(r){return 0<=r&&r<=1}))},bboxoverlap:function(b1,b2){const dims=["x","y"],len=dims.length;for(let dim,l,t,d,i=0;i<len;i++)if(dim=dims[i],l=b1[dim].mid,t=b2[dim].mid,d=(b1[dim].size+b2[dim].size)/2,abs(l-t)>=d)return!1;return!0},expandbox:function(bbox,_bbox){_bbox.x.min<bbox.x.min&&(bbox.x.min=_bbox.x.min),_bbox.y.min<bbox.y.min&&(bbox.y.min=_bbox.y.min),_bbox.z&&_bbox.z.min<bbox.z.min&&(bbox.z.min=_bbox.z.min),_bbox.x.max>bbox.x.max&&(bbox.x.max=_bbox.x.max),_bbox.y.max>bbox.y.max&&(bbox.y.max=_bbox.y.max),_bbox.z&&_bbox.z.max>bbox.z.max&&(bbox.z.max=_bbox.z.max),bbox.x.mid=(bbox.x.min+bbox.x.max)/2,bbox.y.mid=(bbox.y.min+bbox.y.max)/2,bbox.z&&(bbox.z.mid=(bbox.z.min+bbox.z.max)/2),bbox.x.size=bbox.x.max-bbox.x.min,bbox.y.size=bbox.y.max-bbox.y.min,bbox.z&&(bbox.z.size=bbox.z.max-bbox.z.min)},pairiteration:function(c1,c2,curveIntersectionThreshold){const c1b=c1.bbox(),c2b=c2.bbox(),r=1e5,threshold=curveIntersectionThreshold||.5;if(c1b.x.size+c1b.y.size<threshold&&c2b.x.size+c2b.y.size<threshold)return[(r*(c1._t1+c1._t2)/2|0)/r+"/"+(r*(c2._t1+c2._t2)/2|0)/r];let cc1=c1.split(.5),cc2=c2.split(.5),pairs=[{left:cc1.left,right:cc2.left},{left:cc1.left,right:cc2.right},{left:cc1.right,right:cc2.right},{left:cc1.right,right:cc2.left}];pairs=pairs.filter((function(pair){return utils.bboxoverlap(pair.left.bbox(),pair.right.bbox())}));let results=[];return 0===pairs.length||(pairs.forEach((function(pair){results=results.concat(utils.pairiteration(pair.left,pair.right,threshold))})),results=results.filter((function(v,i){return results.indexOf(v)===i}))),results},getccenter:function(p1,p2,p3){const dx1=p2.x-p1.x,dy1=p2.y-p1.y,dx2=p3.x-p2.x,dy2=p3.y-p2.y,dx1p=dx1*cos(quart)-dy1*sin(quart),dy1p=dx1*sin(quart)+dy1*cos(quart),dx2p=dx2*cos(quart)-dy2*sin(quart),dy2p=dx2*sin(quart)+dy2*cos(quart),mx1=(p1.x+p2.x)/2,my1=(p1.y+p2.y)/2,mx2=(p2.x+p3.x)/2,my2=(p2.y+p3.y)/2,mx1n=mx1+dx1p,my1n=my1+dy1p,mx2n=mx2+dx2p,my2n=my2+dy2p,arc=utils.lli8(mx1,my1,mx1n,my1n,mx2,my2,mx2n,my2n),r=utils.dist(arc,p1);let _,s=atan2(p1.y-arc.y,p1.x-arc.x),m=atan2(p2.y-arc.y,p2.x-arc.x),e=atan2(p3.y-arc.y,p3.x-arc.x);return s<e?((s>m||m>e)&&(s+=tau),s>e&&(_=e,e=s,s=_)):e<m&&m<s?(_=e,e=s,s=_):e+=tau,arc.s=s,arc.e=e,arc.r=r,arc},numberSort:function(a,b){return a-b}};class PolyBezier{constructor(curves){this.curves=[],this._3d=!1,curves&&(this.curves=curves,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(curve){return utils.pointsToString(curve.points)})).join(", ")+"]"}addCurve(curve){this.curves.push(curve),this._3d=this._3d||curve._3d}length(){return this.curves.map((function(v){return v.length()})).reduce((function(a,b){return a+b}))}curve(idx){return this.curves[idx]}bbox(){const c=this.curves;for(var bbox=c[0].bbox(),i=1;i<c.length;i++)utils.expandbox(bbox,c[i].bbox());return bbox}offset(d){const offset=[];return this.curves.forEach((function(v){offset.push(...v.offset(d))})),new PolyBezier(offset)}}const{abs:bezier_abs,min:bezier_min,max:bezier_max,cos:bezier_cos,sin:bezier_sin,acos:bezier_acos,sqrt:bezier_sqrt}=Math,bezier_pi=Math.PI;class Bezier{constructor(coords){let args=coords&&coords.forEach?coords:Array.from(arguments).slice(),coordlen=!1;if("object"==typeof args[0]){coordlen=args.length;const newargs=[];args.forEach((function(point){["x","y","z"].forEach((function(d){void 0!==point[d]&&newargs.push(point[d])}))})),args=newargs}let higher=!1;const len=args.length;if(coordlen){if(coordlen>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");higher=!0}}else if(6!==len&&8!==len&&9!==len&&12!==len&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const _3d=this._3d=!higher&&(9===len||12===len)||coords&&coords[0]&&void 0!==coords[0].z,points=this.points=[];for(let idx=0,step=_3d?3:2;idx<len;idx+=step){var point={x:args[idx],y:args[idx+1]};_3d&&(point.z=args[idx+2]),points.push(point)}const order=this.order=points.length-1,dims=this.dims=["x","y"];_3d&&dims.push("z"),this.dimlen=dims.length;const aligned=utils.align(points,{p1:points[0],p2:points[order]}),baselength=utils.dist(points[0],points[order]);this._linear=aligned.reduce(((t,p)=>t+bezier_abs(p.y)),0)<baselength/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(p1,p2,p3,t){if(void 0===t&&(t=.5),0===t)return new Bezier(p2,p2,p3);if(1===t)return new Bezier(p1,p2,p2);const abc=Bezier.getABC(2,p1,p2,p3,t);return new Bezier(p1,abc.A,p3)}static cubicFromPoints(S,B,E,t,d1){void 0===t&&(t=.5);const abc=Bezier.getABC(3,S,B,E,t);void 0===d1&&(d1=utils.dist(B,abc.C));const d2=d1*(1-t)/t,selen=utils.dist(S,E),lx=(E.x-S.x)/selen,ly=(E.y-S.y)/selen,bx1=d1*lx,by1=d1*ly,bx2=d2*lx,by2=d2*ly,e1_x=B.x-bx1,e1_y=B.y-by1,e2_x=B.x+bx2,e2_y=B.y+by2,A=abc.A,v1_x=A.x+(e1_x-A.x)/(1-t),v1_y=A.y+(e1_y-A.y)/(1-t),v2_x=A.x+(e2_x-A.x)/t,v2_y=A.y+(e2_y-A.y)/t,nc1={x:S.x+(v1_x-S.x)/t,y:S.y+(v1_y-S.y)/t},nc2={x:E.x+(v2_x-E.x)/(1-t),y:E.y+(v2_y-E.y)/(1-t)};return new Bezier(S,nc1,nc2,E)}static getUtils(){return utils}getUtils(){return Bezier.getUtils()}static get PolyBezier(){return PolyBezier}valueOf(){return this.toString()}toString(){return utils.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const p=this.points,s=["M",p[0].x,p[0].y,2===this.order?"Q":"C"];for(let i=1,last=p.length;i<last;i++)s.push(p[i].x),s.push(p[i].y);return s.join(" ")}setRatios(ratios){if(ratios.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=ratios,this._lut=[]}verify(){const print=this.coordDigest();print!==this._print&&(this._print=print,this.update())}coordDigest(){return this.points.map((function(c,pos){return""+pos+c.x+c.y+(c.z?c.z:0)})).join("")}update(){this._lut=[],this.dpoints=utils.derive(this.points,this._3d),this.computedirection()}computedirection(){const points=this.points,angle=utils.angle(points[0],points[this.order],points[1]);this.clockwise=angle>0}length(){return utils.length(this.derivative.bind(this))}static getABC(order=2,S,B,E,t=.5){const u=utils.projectionratio(t,order),um=1-u,C={x:u*S.x+um*E.x,y:u*S.y+um*E.y},s=utils.abcratio(t,order);return{A:{x:B.x+(B.x-C.x)/s,y:B.y+(B.y-C.y)/s},B,C,S,E}}getABC(t,B){B=B||this.get(t);let S=this.points[0],E=this.points[this.order];return Bezier.getABC(this.order,S,B,E,t)}getLUT(steps){if(this.verify(),steps=steps||100,this._lut.length===steps+1)return this._lut;this._lut=[],steps++,this._lut=[];for(let p,t,i=0;i<steps;i++)t=i/(steps-1),p=this.compute(t),p.t=t,this._lut.push(p);return this._lut}on(point,error){error=error||5;const lut=this.getLUT(),hits=[];for(let c,i=0,t=0;i<lut.length;i++)c=lut[i],utils.dist(c,point)<error&&(hits.push(c),t+=i/lut.length);return!!hits.length&&(t/=hits.length)}project(point){const LUT=this.getLUT(),l=LUT.length-1,closest=utils.closest(LUT,point),mpos=closest.mpos,t1=(mpos-1)/l,t2=(mpos+1)/l,step=.1/l;let p,mdist=closest.mdist,t=t1,ft=t;mdist+=1;for(let d;t<t2+step;t+=step)p=this.compute(t),d=utils.dist(point,p),d<mdist&&(mdist=d,ft=t);return ft=ft<0?0:ft>1?1:ft,p=this.compute(ft),p.t=ft,p.d=mdist,p}get(t){return this.compute(t)}point(idx){return this.points[idx]}compute(t){return this.ratios?utils.computeWithRatios(t,this.points,this.ratios,this._3d):utils.compute(t,this.points,this._3d,this.ratios)}raise(){const p=this.points,np=[p[0]],k=p.length;for(let pi,pim,i=1;i<k;i++)pi=p[i],pim=p[i-1],np[i]={x:(k-i)/k*pi.x+i/k*pim.x,y:(k-i)/k*pi.y+i/k*pim.y};return np[k]=p[k-1],new Bezier(np)}derivative(t){return utils.compute(t,this.dpoints[0],this._3d)}dderivative(t){return utils.compute(t,this.dpoints[1],this._3d)}align(){let p=this.points;return new Bezier(utils.align(p,{p1:p[0],p2:p[p.length-1]}))}curvature(t){return utils.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return utils.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const d=this.derivative(t),q=bezier_sqrt(d.x*d.x+d.y*d.y);return{t,x:-d.y/q,y:d.x/q}}__normal3(t){const r1=this.derivative(t),r2=this.derivative(t+.01),q1=bezier_sqrt(r1.x*r1.x+r1.y*r1.y+r1.z*r1.z),q2=bezier_sqrt(r2.x*r2.x+r2.y*r2.y+r2.z*r2.z);r1.x/=q1,r1.y/=q1,r1.z/=q1,r2.x/=q2,r2.y/=q2,r2.z/=q2;const c={x:r2.y*r1.z-r2.z*r1.y,y:r2.z*r1.x-r2.x*r1.z,z:r2.x*r1.y-r2.y*r1.x},m=bezier_sqrt(c.x*c.x+c.y*c.y+c.z*c.z);c.x/=m,c.y/=m,c.z/=m;const R=[c.x*c.x,c.x*c.y-c.z,c.x*c.z+c.y,c.x*c.y+c.z,c.y*c.y,c.y*c.z-c.x,c.x*c.z-c.y,c.y*c.z+c.x,c.z*c.z];return{t,x:R[0]*r1.x+R[1]*r1.y+R[2]*r1.z,y:R[3]*r1.x+R[4]*r1.y+R[5]*r1.z,z:R[6]*r1.x+R[7]*r1.y+R[8]*r1.z}}hull(t){let p=this.points,_p=[],q=[],idx=0;for(q[idx++]=p[0],q[idx++]=p[1],q[idx++]=p[2],3===this.order&&(q[idx++]=p[3]);p.length>1;){_p=[];for(let pt,i=0,l=p.length-1;i<l;i++)pt=utils.lerp(t,p[i],p[i+1]),q[idx++]=pt,_p.push(pt);p=_p}return q}split(t1,t2){if(0===t1&&t2)return this.split(t2).left;if(1===t2)return this.split(t1).right;const q=this.hull(t1),result={left:2===this.order?new Bezier([q[0],q[3],q[5]]):new Bezier([q[0],q[4],q[7],q[9]]),right:2===this.order?new Bezier([q[5],q[4],q[2]]):new Bezier([q[9],q[8],q[6],q[3]]),span:q};return result.left._t1=utils.map(0,0,1,this._t1,this._t2),result.left._t2=utils.map(t1,0,1,this._t1,this._t2),result.right._t1=utils.map(t1,0,1,this._t1,this._t2),result.right._t2=utils.map(1,0,1,this._t1,this._t2),t2?(t2=utils.map(t2,t1,1,0,1),result.right.split(t2).left):result}extrema(){const result={};let roots=[];return this.dims.forEach(function(dim){let mfn=function(v){return v[dim]},p=this.dpoints[0].map(mfn);result[dim]=utils.droots(p),3===this.order&&(p=this.dpoints[1].map(mfn),result[dim]=result[dim].concat(utils.droots(p))),result[dim]=result[dim].filter((function(t){return t>=0&&t<=1})),roots=roots.concat(result[dim].sort(utils.numberSort))}.bind(this)),result.values=roots.sort(utils.numberSort).filter((function(v,idx){return roots.indexOf(v)===idx})),result}bbox(){const extrema=this.extrema(),result={};return this.dims.forEach(function(d){result[d]=utils.getminmax(this,d,extrema[d])}.bind(this)),result}overlaps(curve){const lbbox=this.bbox(),tbbox=curve.bbox();return utils.bboxoverlap(lbbox,tbbox)}offset(t,d){if(void 0!==d){const c=this.get(t),n=this.normal(t),ret={c,n,x:c.x+n.x*d,y:c.y+n.y*d};return this._3d&&(ret.z=c.z+n.z*d),ret}if(this._linear){const nv=this.normal(0),coords=this.points.map((function(p){const ret={x:p.x+t*nv.x,y:p.y+t*nv.y};return p.z&&nv.z&&(ret.z=p.z+t*nv.z),ret}));return[new Bezier(coords)]}return this.reduce().map((function(s){return s._linear?s.offset(t)[0]:s.scale(t)}))}simple(){if(3===this.order){const a1=utils.angle(this.points[0],this.points[3],this.points[1]),a2=utils.angle(this.points[0],this.points[3],this.points[2]);if(a1>0&&a2<0||a1<0&&a2>0)return!1}const n1=this.normal(0),n2=this.normal(1);let s=n1.x*n2.x+n1.y*n2.y;return this._3d&&(s+=n1.z*n2.z),bezier_abs(bezier_acos(s))<bezier_pi/3}reduce(){let i,segment,t1=0,t2=0,pass1=[],pass2=[],extrema=this.extrema().values;for(-1===extrema.indexOf(0)&&(extrema=[0].concat(extrema)),-1===extrema.indexOf(1)&&extrema.push(1),t1=extrema[0],i=1;i<extrema.length;i++)t2=extrema[i],segment=this.split(t1,t2),segment._t1=t1,segment._t2=t2,pass1.push(segment),t1=t2;return pass1.forEach((function(p1){for(t1=0,t2=0;t2<=1;)for(t2=t1+.01;t2<=1.01;t2+=.01)if(segment=p1.split(t1,t2),!segment.simple()){if(t2-=.01,bezier_abs(t1-t2)<.01)return[];segment=p1.split(t1,t2),segment._t1=utils.map(t1,0,1,p1._t1,p1._t2),segment._t2=utils.map(t2,0,1,p1._t1,p1._t2),pass2.push(segment),t1=t2;break}t1<1&&(segment=p1.split(t1,1),segment._t1=utils.map(t1,0,1,p1._t1,p1._t2),segment._t2=p1._t2,pass2.push(segment))})),pass2}translate(v,d1,d2){d2="number"==typeof d2?d2:d1;const o=this.order;let d=this.points.map(((_,i)=>(1-i/o)*d1+i/o*d2));return new Bezier(this.points.map(((p,i)=>({x:p.x+v.x*d[i],y:p.y+v.y*d[i]}))))}scale(d){const order=this.order;let distanceFn=!1;if("function"==typeof d&&(distanceFn=d),distanceFn&&2===order)return this.raise().scale(distanceFn);const clockwise=this.clockwise,points=this.points;if(this._linear)return this.translate(this.normal(0),distanceFn?distanceFn(0):d,distanceFn?distanceFn(1):d);const r1=distanceFn?distanceFn(0):d,r2=distanceFn?distanceFn(1):d,v=[this.offset(0,10),this.offset(1,10)],np=[],o=utils.lli4(v[0],v[0].c,v[1],v[1].c);if(!o)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const p=np[t*order]=utils.copy(points[t*order]);p.x+=(t?r2:r1)*v[t].n.x,p.y+=(t?r2:r1)*v[t].n.y})),distanceFn?([0,1].forEach((function(t){if(2!==order||!t){var p=points[t+1],ov={x:p.x-o.x,y:p.y-o.y},rc=distanceFn?distanceFn((t+1)/order):d;distanceFn&&!clockwise&&(rc=-rc);var m=bezier_sqrt(ov.x*ov.x+ov.y*ov.y);ov.x/=m,ov.y/=m,np[t+1]={x:p.x+rc*ov.x,y:p.y+rc*ov.y}}})),new Bezier(np)):([0,1].forEach((t=>{if(2===order&&t)return;const p=np[t*order],d=this.derivative(t),p2={x:p.x+d.x,y:p.y+d.y};np[t+1]=utils.lli4(p,p2,o,points[t+1])})),new Bezier(np))}outline(d1,d2,d3,d4){if(d2=void 0===d2?d1:d2,this._linear){const n=this.normal(0),start=this.points[0],end=this.points[this.points.length-1];let s,mid,e;void 0===d3&&(d3=d1,d4=d2),s={x:start.x+n.x*d1,y:start.y+n.y*d1},e={x:end.x+n.x*d3,y:end.y+n.y*d3},mid={x:(s.x+e.x)/2,y:(s.y+e.y)/2};const fline=[s,mid,e];s={x:start.x-n.x*d2,y:start.y-n.y*d2},e={x:end.x-n.x*d4,y:end.y-n.y*d4},mid={x:(s.x+e.x)/2,y:(s.y+e.y)/2};const bline=[e,mid,s],ls=utils.makeline(bline[2],fline[0]),le=utils.makeline(fline[2],bline[0]),segments=[ls,new Bezier(fline),le,new Bezier(bline)];return new PolyBezier(segments)}const reduced=this.reduce(),len=reduced.length,fcurves=[];let p,bcurves=[],alen=0,tlen=this.length();const graduated=void 0!==d3&&void 0!==d4;function linearDistanceFunction(s,e,tlen,alen,slen){return function(v){const f1=alen/tlen,f2=(alen+slen)/tlen,d=e-s;return utils.map(v,0,1,s+f1*d,s+f2*d)}}reduced.forEach((function(segment){const slen=segment.length();graduated?(fcurves.push(segment.scale(linearDistanceFunction(d1,d3,tlen,alen,slen))),bcurves.push(segment.scale(linearDistanceFunction(-d2,-d4,tlen,alen,slen)))):(fcurves.push(segment.scale(d1)),bcurves.push(segment.scale(-d2))),alen+=slen})),bcurves=bcurves.map((function(s){return p=s.points,p[3]?s.points=[p[3],p[2],p[1],p[0]]:s.points=[p[2],p[1],p[0]],s})).reverse();const fs=fcurves[0].points[0],fe=fcurves[len-1].points[fcurves[len-1].points.length-1],bs=bcurves[len-1].points[bcurves[len-1].points.length-1],be=bcurves[0].points[0],ls=utils.makeline(bs,fs),le=utils.makeline(fe,be),segments=[ls].concat(fcurves).concat([le]).concat(bcurves);return new PolyBezier(segments)}outlineshapes(d1,d2,curveIntersectionThreshold){d2=d2||d1;const outline=this.outline(d1,d2).curves,shapes=[];for(let i=1,len=outline.length;i<len/2;i++){const shape=utils.makeshape(outline[i],outline[len-i],curveIntersectionThreshold);shape.startcap.virtual=i>1,shape.endcap.virtual=i<len/2-1,shapes.push(shape)}return shapes}intersects(curve,curveIntersectionThreshold){return curve?curve.p1&&curve.p2?this.lineIntersects(curve):(curve instanceof Bezier&&(curve=curve.reduce()),this.curveintersects(this.reduce(),curve,curveIntersectionThreshold)):this.selfintersects(curveIntersectionThreshold)}lineIntersects(line){const mx=bezier_min(line.p1.x,line.p2.x),my=bezier_min(line.p1.y,line.p2.y),MX=bezier_max(line.p1.x,line.p2.x),MY=bezier_max(line.p1.y,line.p2.y);return utils.roots(this.points,line).filter((t=>{var p=this.get(t);return utils.between(p.x,mx,MX)&&utils.between(p.y,my,MY)}))}selfintersects(curveIntersectionThreshold){const reduced=this.reduce(),len=reduced.length-2,results=[];for(let result,left,right,i=0;i<len;i++)left=reduced.slice(i,i+1),right=reduced.slice(i+2),result=this.curveintersects(left,right,curveIntersectionThreshold),results.push(...result);return results}curveintersects(c1,c2,curveIntersectionThreshold){const pairs=[];c1.forEach((function(l){c2.forEach((function(r){l.overlaps(r)&&pairs.push({left:l,right:r})}))}));let intersections=[];return pairs.forEach((function(pair){const result=utils.pairiteration(pair.left,pair.right,curveIntersectionThreshold);result.length>0&&(intersections=intersections.concat(result))})),intersections}arcs(errorThreshold){return errorThreshold=errorThreshold||.5,this._iterate(errorThreshold,[])}_error(pc,np1,s,e){const q=(e-s)/4,c1=this.get(s+q),c2=this.get(e-q),ref=utils.dist(pc,np1),d1=utils.dist(pc,c1),d2=utils.dist(pc,c2);return bezier_abs(d1-ref)+bezier_abs(d2-ref)}_iterate(errorThreshold,circles){let safety,t_s=0,t_e=1;do{safety=0,t_e=1;let np2,np3,arc,prev_arc,done,np1=this.get(t_s),curr_good=!1,prev_good=!1,t_m=t_e,prev_e=1,step=0;do{if(prev_good=curr_good,prev_arc=arc,t_m=(t_s+t_e)/2,step++,np2=this.get(t_m),np3=this.get(t_e),arc=utils.getccenter(np1,np2,np3),arc.interval={start:t_s,end:t_e},curr_good=this._error(arc,np1,t_s,t_e)<=errorThreshold,done=prev_good&&!curr_good,done||(prev_e=t_e),curr_good){if(t_e>=1){if(arc.interval.end=prev_e=1,prev_arc=arc,t_e>1){let d={x:arc.x+arc.r*bezier_cos(arc.e),y:arc.y+arc.r*bezier_sin(arc.e)};arc.e+=utils.angle({x:arc.x,y:arc.y},d,this.get(1))}break}t_e+=(t_e-t_s)/2}else t_e=t_m}while(!done&&safety++<100);if(safety>=100)break;prev_arc=prev_arc||arc,circles.push(prev_arc),t_s=prev_e}while(t_e<1);return circles}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function index_array_by_slicedToArray(arr,i){return function index_array_by_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function index_array_by_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||index_array_by_unsupportedIterableToArray(arr,i)||function index_array_by_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function index_array_by_toConsumableArray(arr){return function index_array_by_arrayWithoutHoles(arr){if(Array.isArray(arr))return index_array_by_arrayLikeToArray(arr)}(arr)||function index_array_by_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||index_array_by_unsupportedIterableToArray(arr)||function index_array_by_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function index_array_by_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return index_array_by_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?index_array_by_arrayLikeToArray(o,minLen):void 0}}function index_array_by_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function index_array_by_toPropertyKey(arg){var key=function index_array_by_toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}class InternMap extends Map{constructor(entries,key=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:key}}),null!=entries)for(const[key,value]of entries)this.set(key,value)}get(key){return super.get(intern_get(this,key))}has(key){return super.has(intern_get(this,key))}set(key,value){return super.set(intern_set(this,key),value)}delete(key){return super.delete(intern_delete(this,key))}}Set;function intern_get({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):value}function intern_set({_intern,_key},value){const key=_key(value);return _intern.has(key)?_intern.get(key):(_intern.set(key,value),value)}function intern_delete({_intern,_key},value){const key=_key(value);return _intern.has(key)&&(value=_intern.get(key),_intern.delete(key)),value}function keyof(value){return null!==value&&"object"==typeof value?value.valueOf():value}function initRange(domain,range){switch(arguments.length){case 0:break;case 1:this.range(domain);break;default:this.range(range).domain(domain)}return this}const implicit=Symbol("implicit");const Paired=function colors(specifier){for(var n=specifier.length/6|0,colors=new Array(n),i=0;i<n;)colors[i]="#"+specifier.slice(6*i,6*++i);return colors}("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function force_graph_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];return o.push.apply(o,e),new(t.bind.apply(t,o))}function force_graph_defineProperty(e,r,t){return(r=function force_graph_toPropertyKey(t){var i=function force_graph_toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function force_graph_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function force_graph_objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?force_graph_ownKeys(Object(t),!0).forEach((function(r){force_graph_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):force_graph_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function force_graph_slicedToArray(r,e){return function force_graph_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function force_graph_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l);else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||force_graph_unsupportedIterableToArray(r,e)||function force_graph_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function force_graph_toConsumableArray(r){return function force_graph_arrayWithoutHoles(r){if(Array.isArray(r))return force_graph_arrayLikeToArray(r)}(r)||function force_graph_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||force_graph_unsupportedIterableToArray(r)||function force_graph_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function force_graph_typeof(o){return force_graph_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},force_graph_typeof(o)}function force_graph_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return force_graph_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?force_graph_arrayLikeToArray(r,a):void 0}}!function force_graph_styleInject(css,ref){void 0===ref&&(ref={});var insertAt=ref.insertAt;if("undefined"!=typeof document){var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css","top"===insertAt&&head.firstChild?head.insertBefore(style,head.firstChild):head.appendChild(style),style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css))}}(".force-graph-container canvas {\n  display: block;\n  user-select: none;\n  outline: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.force-graph-container .clickable {\n  cursor: pointer;\n}\n\n.force-graph-container .grabbable {\n  cursor: move;\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n.force-graph-container .grabbable:active {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}\n");var autoColorScale=function ordinal(){var index=new InternMap,domain=[],range=[],unknown=implicit;function scale(d){let i=index.get(d);if(void 0===i){if(unknown!==implicit)return unknown;index.set(d,i=domain.push(d)-1)}return range[i%range.length]}return scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=new InternMap;for(const value of _)index.has(value)||index.set(value,domain.push(value)-1);return scale},scale.range=function(_){return arguments.length?(range=Array.from(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal(domain,range).unknown(unknown)},initRange.apply(scale,arguments),scale}(Paired);function autoColorObjects(objects,colorByAccessor,colorField){colorByAccessor&&"string"==typeof colorField&&objects.filter((function(obj){return!obj[colorField]})).forEach((function(obj){obj[colorField]=autoColorScale(colorByAccessor(obj))}))}var notifyRedraw=function notifyRedraw(_,state){return state.onNeedsRedraw&&state.onNeedsRedraw()},updDataPhotons=function updDataPhotons(_,state){if(!state.isShadow){var linkParticlesAccessor=accessor_fn_index(state.linkDirectionalParticles);state.graphData.links.forEach((function(link){var numPhotons=Math.round(Math.abs(linkParticlesAccessor(link)));numPhotons?link.__photons=force_graph_toConsumableArray(Array(numPhotons)).map((function(){return{}})):delete link.__photons}))}},CanvasForceGraph=kapsule_index({props:{graphData:{default:{nodes:[],links:[]},onChange:function onChange(_,state){state.engineRunning=!1,updDataPhotons(0,state)}},dagMode:{onChange:function onChange(dagMode,state){!dagMode&&(state.graphData.nodes||[]).forEach((function(n){return n.fx=n.fy=void 0}))}},dagLevelDistance:{},dagNodeFilter:{default:function _default(node){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:notifyRedraw},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:notifyRedraw},nodeColor:{default:"color",triggerUpdate:!1,onChange:notifyRedraw},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:notifyRedraw},nodeCanvasObjectMode:{default:function _default(){return"replace"},triggerUpdate:!1,onChange:notifyRedraw},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:notifyRedraw},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:notifyRedraw},linkColor:{default:"color",triggerUpdate:!1,onChange:notifyRedraw},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:notifyRedraw},linkWidth:{default:1,triggerUpdate:!1,onChange:notifyRedraw},linkCurvature:{default:0,triggerUpdate:!1,onChange:notifyRedraw},linkCanvasObject:{triggerUpdate:!1,onChange:notifyRedraw},linkCanvasObjectMode:{default:function _default(){return"replace"},triggerUpdate:!1,onChange:notifyRedraw},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:notifyRedraw},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:notifyRedraw},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:notifyRedraw},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:updDataPhotons},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function onChange(alphaDecay,state){state.forceLayout.alphaDecay(alphaDecay)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function onChange(alphaTarget,state){state.forceLayout.alphaTarget(alphaTarget)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function onChange(velocityDecay,state){state.forceLayout.velocityDecay(velocityDecay)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function _default(){},triggerUpdate:!1},onFinishUpdate:{default:function _default(){},triggerUpdate:!1},onEngineTick:{default:function _default(){},triggerUpdate:!1},onEngineStop:{default:function _default(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function d3Force(state,forceName,forceFn){return void 0===forceFn?state.forceLayout.force(forceName):(state.forceLayout.force(forceName,forceFn),this)},d3ReheatSimulation:function d3ReheatSimulation(state){return state.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function resetCountdown(state){return state.cntTicks=0,state.startTickTime=new Date,state.engineRunning=!0,this},isEngineRunning:function isEngineRunning(state){return!!state.engineRunning},tickFrame:function tickFrame(state){return!state.isShadow&&function layoutTick(){state.engineRunning&&(++state.cntTicks>state.cooldownTicks||new Date-state.startTickTime>state.cooldownTime||state.d3AlphaMin>0&&state.forceLayout.alpha()<state.d3AlphaMin?(state.engineRunning=!1,state.onEngineStop()):(state.forceLayout.tick(),state.onEngineTick()))}(),function paintLinks(){var getVisibility=accessor_fn_index(state.linkVisibility),getColor=accessor_fn_index(state.linkColor),getWidth=accessor_fn_index(state.linkWidth),getLineDash=accessor_fn_index(state.linkLineDash),getCurvature=accessor_fn_index(state.linkCurvature),getLinkCanvasObjectMode=accessor_fn_index(state.linkCanvasObjectMode),ctx=state.ctx,padAmount=2*state.isShadow,visibleLinks=state.graphData.links.filter(getVisibility);visibleLinks.forEach((function calcLinkControlPoints(link){var curvature=getCurvature(link);if(!curvature)return void(link.__controlPoints=null);var start=link.source,end=link.target;if(!(start&&end&&start.hasOwnProperty("x")&&end.hasOwnProperty("x")))return;var l=Math.sqrt(Math.pow(end.x-start.x,2)+Math.pow(end.y-start.y,2));if(l>0){var a=Math.atan2(end.y-start.y,end.x-start.x),d=l*curvature,cp={x:(start.x+end.x)/2+d*Math.cos(a-Math.PI/2),y:(start.y+end.y)/2+d*Math.sin(a-Math.PI/2)};link.__controlPoints=[cp.x,cp.y]}else{var _d=70*curvature;link.__controlPoints=[end.x,end.y-_d,end.x+_d,end.y]}}));var beforeCustomLinks=[],afterCustomLinks=[],defaultPaintLinks=visibleLinks;if(state.linkCanvasObject){var replaceCustomLinks=[],otherCustomLinks=[];visibleLinks.forEach((function(d){return({before:beforeCustomLinks,after:afterCustomLinks,replace:replaceCustomLinks}[getLinkCanvasObjectMode(d)]||otherCustomLinks).push(d)})),defaultPaintLinks=[].concat(force_graph_toConsumableArray(beforeCustomLinks),afterCustomLinks,otherCustomLinks),beforeCustomLinks=beforeCustomLinks.concat(replaceCustomLinks)}ctx.save(),beforeCustomLinks.forEach((function(link){return state.linkCanvasObject(link,ctx,state.globalScale)})),ctx.restore();var linksPerColor=function(){var list=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],keyAccessors=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],multiItem=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],flattenKeys=arguments.length>3&&void 0!==arguments[3]&&arguments[3],keys=(keyAccessors instanceof Array?keyAccessors.length?keyAccessors:[void 0]:[keyAccessors]).map((function(key){return{keyAccessor:key,isProp:!(key instanceof Function)}})),indexedResult=list.reduce((function(res,item){var iterObj=res,itemVal=item;return keys.forEach((function(_ref,idx){var key,keyAccessor=_ref.keyAccessor;if(_ref.isProp){var _itemVal=itemVal,propVal=_itemVal[keyAccessor],rest=_objectWithoutProperties(_itemVal,[keyAccessor].map(index_array_by_toPropertyKey));key=propVal,itemVal=rest}else key=keyAccessor(itemVal,idx);idx+1<keys.length?(iterObj.hasOwnProperty(key)||(iterObj[key]={}),iterObj=iterObj[key]):multiItem?(iterObj.hasOwnProperty(key)||(iterObj[key]=[]),iterObj[key].push(itemVal)):iterObj[key]=itemVal})),res}),{});multiItem instanceof Function&&function reduce(node){var level=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;level===keys.length?Object.keys(node).forEach((function(k){return node[k]=multiItem(node[k])})):Object.values(node).forEach((function(child){return reduce(child,level+1)}))}(indexedResult);var result=indexedResult;return flattenKeys&&(result=[],function flatten(node){var accKeys=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];accKeys.length===keys.length?result.push({keys:accKeys,vals:node}):Object.entries(node).forEach((function(_ref2){var _ref3=index_array_by_slicedToArray(_ref2,2),key=_ref3[0],val=_ref3[1];return flatten(val,[].concat(index_array_by_toConsumableArray(accKeys),[key]))}))}(indexedResult),keyAccessors instanceof Array&&0===keyAccessors.length&&1===result.length&&(result[0].keys=[])),result}(defaultPaintLinks,[getColor,getWidth,getLineDash]);ctx.save(),Object.entries(linksPerColor).forEach((function(_ref){var _ref2=force_graph_slicedToArray(_ref,2),color=_ref2[0],linksPerWidth=_ref2[1],lineColor=color&&"undefined"!==color?color:"rgba(0,0,0,0.15)";Object.entries(linksPerWidth).forEach((function(_ref3){var _ref4=force_graph_slicedToArray(_ref3,2),width=_ref4[0],linesPerLineDash=_ref4[1],lineWidth=(width||1)/state.globalScale+padAmount;Object.entries(linesPerLineDash).forEach((function(_ref5){var _ref6=force_graph_slicedToArray(_ref5,2);_ref6[0];var links=_ref6[1],lineDashSegments=getLineDash(links[0]);ctx.beginPath(),links.forEach((function(link){var start=link.source,end=link.target;if(start&&end&&start.hasOwnProperty("x")&&end.hasOwnProperty("x")){ctx.moveTo(start.x,start.y);var controlPoints=link.__controlPoints;controlPoints?ctx[2===controlPoints.length?"quadraticCurveTo":"bezierCurveTo"].apply(ctx,force_graph_toConsumableArray(controlPoints).concat([end.x,end.y])):ctx.lineTo(end.x,end.y)}})),ctx.strokeStyle=lineColor,ctx.lineWidth=lineWidth,ctx.setLineDash(lineDashSegments||[]),ctx.stroke()}))}))})),ctx.restore(),ctx.save(),afterCustomLinks.forEach((function(link){return state.linkCanvasObject(link,ctx,state.globalScale)})),ctx.restore()}(),!state.isShadow&&function paintArrows(){var getLength=accessor_fn_index(state.linkDirectionalArrowLength),getRelPos=accessor_fn_index(state.linkDirectionalArrowRelPos),getVisibility=accessor_fn_index(state.linkVisibility),getColor=accessor_fn_index(state.linkDirectionalArrowColor||state.linkColor),getNodeVal=accessor_fn_index(state.nodeVal),ctx=state.ctx;ctx.save(),state.graphData.links.filter(getVisibility).forEach((function(link){var arrowLength=getLength(link);if(arrowLength&&!(arrowLength<0)){var start=link.source,end=link.target;if(start&&end&&start.hasOwnProperty("x")&&end.hasOwnProperty("x")){var startR=Math.sqrt(Math.max(0,getNodeVal(start)||1))*state.nodeRelSize,endR=Math.sqrt(Math.max(0,getNodeVal(end)||1))*state.nodeRelSize,arrowRelPos=Math.min(1,Math.max(0,getRelPos(link))),arrowColor=getColor(link)||"rgba(0,0,0,0.28)",arrowHalfWidth=arrowLength/1.6/2,bzLine=link.__controlPoints&&_construct(Bezier,[start.x,start.y].concat(force_graph_toConsumableArray(link.__controlPoints),[end.x,end.y])),getCoordsAlongLine=bzLine?function(t){return bzLine.get(t)}:function(t){return{x:start.x+(end.x-start.x)*t||0,y:start.y+(end.y-start.y)*t||0}},lineLen=bzLine?bzLine.length():Math.sqrt(Math.pow(end.x-start.x,2)+Math.pow(end.y-start.y,2)),posAlongLine=startR+arrowLength+(lineLen-startR-endR-arrowLength)*arrowRelPos,arrowHead=getCoordsAlongLine(posAlongLine/lineLen),arrowTail=getCoordsAlongLine((posAlongLine-arrowLength)/lineLen),arrowTailVertex=getCoordsAlongLine((posAlongLine-.8*arrowLength)/lineLen),arrowTailAngle=Math.atan2(arrowHead.y-arrowTail.y,arrowHead.x-arrowTail.x)-Math.PI/2;ctx.beginPath(),ctx.moveTo(arrowHead.x,arrowHead.y),ctx.lineTo(arrowTail.x+arrowHalfWidth*Math.cos(arrowTailAngle),arrowTail.y+arrowHalfWidth*Math.sin(arrowTailAngle)),ctx.lineTo(arrowTailVertex.x,arrowTailVertex.y),ctx.lineTo(arrowTail.x-arrowHalfWidth*Math.cos(arrowTailAngle),arrowTail.y-arrowHalfWidth*Math.sin(arrowTailAngle)),ctx.fillStyle=arrowColor,ctx.fill()}}})),ctx.restore()}(),!state.isShadow&&function paintPhotons(){var getNumPhotons=accessor_fn_index(state.linkDirectionalParticles),getSpeed=accessor_fn_index(state.linkDirectionalParticleSpeed),getOffset=accessor_fn_index(state.linkDirectionalParticleOffset),getDiameter=accessor_fn_index(state.linkDirectionalParticleWidth),getVisibility=accessor_fn_index(state.linkVisibility),getColor=accessor_fn_index(state.linkDirectionalParticleColor||state.linkColor),ctx=state.ctx;ctx.save(),state.graphData.links.filter(getVisibility).forEach((function(link){var numCyclePhotons=getNumPhotons(link);if(link.hasOwnProperty("__photons")&&link.__photons.length){var start=link.source,end=link.target;if(start&&end&&start.hasOwnProperty("x")&&end.hasOwnProperty("x")){var particleSpeed=getSpeed(link),particleOffset=Math.abs(getOffset(link)),photons=link.__photons||[],photonR=Math.max(0,getDiameter(link)/2)/Math.sqrt(state.globalScale),photonColor=getColor(link)||"rgba(0,0,0,0.28)";ctx.fillStyle=photonColor;var bzLine=link.__controlPoints?_construct(Bezier,[start.x,start.y].concat(force_graph_toConsumableArray(link.__controlPoints),[end.x,end.y])):null,cyclePhotonIdx=0,needsCleanup=!1;photons.forEach((function(photon){var singleHop=!!photon.__singleHop;if(photon.hasOwnProperty("__progressRatio")||(photon.__progressRatio=singleHop?0:(cyclePhotonIdx+particleOffset)/numCyclePhotons),!singleHop&&cyclePhotonIdx++,photon.__progressRatio+=particleSpeed,photon.__progressRatio>=1){if(singleHop)return void(needsCleanup=!0);photon.__progressRatio=photon.__progressRatio%1}var photonPosRatio=photon.__progressRatio,coords=bzLine?bzLine.get(photonPosRatio):{x:start.x+(end.x-start.x)*photonPosRatio||0,y:start.y+(end.y-start.y)*photonPosRatio||0};state.linkDirectionalParticleCanvasObject?state.linkDirectionalParticleCanvasObject(coords.x,coords.y,link,ctx,state.globalScale):(ctx.beginPath(),ctx.arc(coords.x,coords.y,photonR,0,2*Math.PI,!1),ctx.fill())})),needsCleanup&&(link.__photons=link.__photons.filter((function(photon){return!photon.__singleHop||photon.__progressRatio<=1})))}}})),ctx.restore()}(),function paintNodes(){var getVisibility=accessor_fn_index(state.nodeVisibility),getVal=accessor_fn_index(state.nodeVal),getColor=accessor_fn_index(state.nodeColor),getNodeCanvasObjectMode=accessor_fn_index(state.nodeCanvasObjectMode),ctx=state.ctx,padAmount=state.isShadow/state.globalScale,visibleNodes=state.graphData.nodes.filter(getVisibility);ctx.save(),visibleNodes.forEach((function(node){var nodeCanvasObjectMode=getNodeCanvasObjectMode(node);if(!state.nodeCanvasObject||"before"!==nodeCanvasObjectMode&&"replace"!==nodeCanvasObjectMode||(state.nodeCanvasObject(node,ctx,state.globalScale),"replace"!==nodeCanvasObjectMode)){var r=Math.sqrt(Math.max(0,getVal(node)||1))*state.nodeRelSize+padAmount;ctx.beginPath(),ctx.arc(node.x,node.y,r,0,2*Math.PI,!1),ctx.fillStyle=getColor(node)||"rgba(31, 120, 180, 0.92)",ctx.fill(),state.nodeCanvasObject&&"after"===nodeCanvasObjectMode&&state.nodeCanvasObject(node,state.ctx,state.globalScale)}else ctx.restore()})),ctx.restore()}(),this},emitParticle:function emitParticle(state,link){return link&&(!link.__photons&&(link.__photons=[]),link.__photons.push({__singleHop:!0})),this}},stateInit:function stateInit(){return{forceLayout:simulation().force("link",src_link()).force("charge",manyBody()).force("center",center()).force("dagRadial",null).stop(),engineRunning:!1}},init:function init(canvasCtx,state){state.ctx=canvasCtx},update:function update(state,changedProps){state.engineRunning=!1,state.onUpdate(),null!==state.nodeAutoColorBy&&autoColorObjects(state.graphData.nodes,accessor_fn_index(state.nodeAutoColorBy),state.nodeColor),null!==state.linkAutoColorBy&&autoColorObjects(state.graphData.links,accessor_fn_index(state.linkAutoColorBy),state.linkColor),state.graphData.links.forEach((function(link){link.source=link[state.linkSource],link.target=link[state.linkTarget]})),state.forceLayout.stop().alpha(1).nodes(state.graphData.nodes);var linkForce=state.forceLayout.force("link");linkForce&&linkForce.id((function(d){return d[state.nodeId]})).links(state.graphData.links);var nodeDepths=state.dagMode&&function getDagDepths(_ref,idAccessor){var nodes=_ref.nodes,links=_ref.links,_ref2=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_ref2$nodeFilter=_ref2.nodeFilter,nodeFilter=void 0===_ref2$nodeFilter?function(){return!0}:_ref2$nodeFilter,_ref2$onLoopError=_ref2.onLoopError,onLoopError=void 0===_ref2$onLoopError?function(loopIds){throw"Invalid DAG structure! Found cycle in node path: ".concat(loopIds.join(" -> "),".")}:_ref2$onLoopError,graph={};nodes.forEach((function(node){return graph[idAccessor(node)]={data:node,out:[],depth:-1,skip:!nodeFilter(node)}})),links.forEach((function(_ref3){var source=_ref3.source,target=_ref3.target,sourceId=getNodeId(source),targetId=getNodeId(target);if(!graph.hasOwnProperty(sourceId))throw"Missing source node with id: ".concat(sourceId);if(!graph.hasOwnProperty(targetId))throw"Missing target node with id: ".concat(targetId);var sourceNode=graph[sourceId],targetNode=graph[targetId];function getNodeId(node){return"object"===force_graph_typeof(node)?idAccessor(node):node}sourceNode.out.push(targetNode)}));var foundLoops=[];return function traverse(nodes){for(var nodeStack=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],currentDepth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_loop=function _loop(){var node=nodes[i];if(-1!==nodeStack.indexOf(node)){var loop=[].concat(force_graph_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))),[node]).map((function(d){return idAccessor(d.data)}));return foundLoops.some((function(foundLoop){return foundLoop.length===loop.length&&foundLoop.every((function(id,idx){return id===loop[idx]}))}))||(foundLoops.push(loop),onLoopError(loop)),1}currentDepth>node.depth&&(node.depth=currentDepth,traverse(node.out,[].concat(force_graph_toConsumableArray(nodeStack),[node]),currentDepth+(node.skip?0:1)))},i=0,l=nodes.length;i<l;i++)_loop()}(Object.values(graph)),Object.assign.apply(Object,[{}].concat(force_graph_toConsumableArray(Object.entries(graph).filter((function(_ref4){return!force_graph_slicedToArray(_ref4,2)[1].skip})).map((function(_ref6){var _ref7=force_graph_slicedToArray(_ref6,2);return force_graph_defineProperty({},_ref7[0],_ref7[1].depth)})))))}(state.graphData,(function(node){return node[state.nodeId]}),{nodeFilter:state.dagNodeFilter,onLoopError:state.onDagError||void 0}),maxDepth=Math.max.apply(Math,force_graph_toConsumableArray(Object.values(nodeDepths||[]))),dagLevelDistance=state.dagLevelDistance||state.graphData.nodes.length/(maxDepth||1)*2*(-1!==["radialin","radialout"].indexOf(state.dagMode)?.7:1);if(["lr","rl","td","bu"].includes(changedProps.dagMode)){var resetProp=["lr","rl"].includes(changedProps.dagMode)?"fx":"fy";state.graphData.nodes.filter(state.dagNodeFilter).forEach((function(node){return delete node[resetProp]}))}if(["lr","rl","td","bu"].includes(state.dagMode)){var invert=["rl","bu"].includes(state.dagMode),_resetProp=["lr","rl"].includes(state.dagMode)?"fx":"fy";state.graphData.nodes.filter(state.dagNodeFilter).forEach((function(node){return node[_resetProp]=function fixFn(node){return(nodeDepths[node[state.nodeId]]-maxDepth/2)*dagLevelDistance*(invert?-1:1)}(node)}))}state.forceLayout.force("dagRadial",-1!==["radialin","radialout"].indexOf(state.dagMode)?function radial(radius,x,y,z){var nodes,nDim,strengths,radiuses,strength=d3_force_3d_src_constant(.1);function force(alpha){for(var i=0,n=nodes.length;i<n;++i){var node=nodes[i],dx=node.x-x||1e-6,dy=(node.y||0)-y||1e-6,dz=(node.z||0)-z||1e-6,r=Math.sqrt(dx*dx+dy*dy+dz*dz),k=(radiuses[i]-r)*strengths[i]*alpha/r;node.vx+=dx*k,nDim>1&&(node.vy+=dy*k),nDim>2&&(node.vz+=dz*k)}}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),radiuses=new Array(n),i=0;i<n;++i)radiuses[i]=+radius(nodes[i],i,nodes),strengths[i]=isNaN(radiuses[i])?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof radius&&(radius=d3_force_3d_src_constant(+radius)),null==x&&(x=0),null==y&&(y=0),null==z&&(z=0),force.initialize=function(initNodes,...args){nodes=initNodes,nDim=args.find((arg=>[1,2,3].includes(arg)))||2,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:d3_force_3d_src_constant(+_),initialize(),force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:d3_force_3d_src_constant(+_),initialize(),force):radius},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force.z=function(_){return arguments.length?(z=+_,force):z},force}((function(node){var nodeDepth=nodeDepths[node[state.nodeId]]||-1;return("radialin"===state.dagMode?maxDepth-nodeDepth:nodeDepth)*dagLevelDistance})).strength((function(node){return state.dagNodeFilter(node)?1:0})):null);for(var i=0;i<state.warmupTicks&&!(state.d3AlphaMin>0&&state.forceLayout.alpha()<state.d3AlphaMin);i++)state.forceLayout.tick();this.resetCountdown(),state.onFinishUpdate()}});function linkKapsule(kapsulePropNames,kapsuleType){var propNames=kapsulePropNames instanceof Array?kapsulePropNames:[kapsulePropNames],dummyK=new kapsuleType;return dummyK._destructor&&dummyK._destructor(),{linkProp:function linkProp(prop){return{default:dummyK[prop](),onChange:function onChange(v,state){propNames.forEach((function(propName){return state[propName][prop](v)}))},triggerUpdate:!1}},linkMethod:function linkMethod(method){return function(state){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var returnVals=[];return propNames.forEach((function(propName){var kapsuleInstance=state[propName],returnVal=kapsuleInstance[method].apply(kapsuleInstance,args);returnVal!==kapsuleInstance&&returnVals.push(returnVal)})),returnVals.length?returnVals[0]:this}}}}var bindFG=linkKapsule("forceGraph",CanvasForceGraph),bindBoth=linkKapsule(["forceGraph","shadowGraph"],CanvasForceGraph),linkedProps=Object.assign.apply(Object,force_graph_toConsumableArray(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map((function(p){return force_graph_defineProperty({},p,bindFG.linkProp(p))}))).concat(force_graph_toConsumableArray(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map((function(p){return force_graph_defineProperty({},p,bindBoth.linkProp(p))}))))),linkedMethods=Object.assign.apply(Object,force_graph_toConsumableArray(["d3Force","d3ReheatSimulation","emitParticle"].map((function(p){return force_graph_defineProperty({},p,bindFG.linkMethod(p))}))));function adjustCanvasSize(state){if(state.canvas){var curWidth=state.canvas.width,curHeight=state.canvas.height;300===curWidth&&150===curHeight&&(curWidth=curHeight=0);var pxScale=window.devicePixelRatio;curWidth/=pxScale,curHeight/=pxScale,[state.canvas,state.shadowCanvas].forEach((function(canvas){canvas.style.width="".concat(state.width,"px"),canvas.style.height="".concat(state.height,"px"),canvas.width=state.width*pxScale,canvas.height=state.height*pxScale,curWidth||curHeight||canvas.getContext("2d").scale(pxScale,pxScale)}));var k=transform(state.canvas).k;state.zoom.translateBy(state.zoom.__baseElem,(state.width-curWidth)/2/k,(state.height-curHeight)/2/k),state.needsRedraw=!0}}function resetTransform(ctx){var pxRatio=window.devicePixelRatio;ctx.setTransform(pxRatio,0,0,pxRatio,0,0)}function clearCanvas(ctx,width,height){ctx.save(),resetTransform(ctx),ctx.clearRect(0,0,width,height),ctx.restore()}var forceGraph=kapsule_index({props:force_graph_objectSpread2({width:{default:window.innerWidth,onChange:function onChange(_,state){return adjustCanvasSize(state)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function onChange(_,state){return adjustCanvasSize(state)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function onChange(d,state){[d.nodes,d.links].every((function(arr){return(arr||[]).every((function(d){return!d.hasOwnProperty("__indexColor")}))}))&&state.colorTracker.reset(),[{type:"Node",objs:d.nodes},{type:"Link",objs:d.links}].forEach((function hexIndex(_ref4){var type=_ref4.type;_ref4.objs.filter((function(d){if(!d.hasOwnProperty("__indexColor"))return!0;var cur=state.colorTracker.lookup(d.__indexColor);return!cur||!cur.hasOwnProperty("d")||cur.d!==d})).forEach((function(d){d.__indexColor=state.colorTracker.register({type,d})}))})),state.forceGraph.graphData(d),state.shadowGraph.graphData(d)},triggerUpdate:!1},backgroundColor:{onChange:function onChange(color,state){state.canvas&&color&&(state.canvas.style.background=color)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function onChange(paintFn,state){state.shadowGraph.nodeCanvasObject(paintFn?function(node,ctx,globalScale){return paintFn(node,node.__indexColor,ctx,globalScale)}:null),state.flushShadowCanvas&&state.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function onChange(paintFn,state){state.shadowGraph.linkCanvasObject(paintFn?function(link,ctx,globalScale){return paintFn(link,link.__indexColor,ctx,globalScale)}:null),state.flushShadowCanvas&&state.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function onChange(minZoom,state){state.zoom.scaleExtent([minZoom,state.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function onChange(maxZoom,state){state.zoom.scaleExtent([state.zoom.scaleExtent()[0],maxZoom])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function onChange(_,state){state.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function _default(){},triggerUpdate:!1},onNodeDragEnd:{default:function _default(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},linkedProps),aliases:{stopAnimation:"pauseAnimation"},methods:force_graph_objectSpread2({graph2ScreenCoords:function graph2ScreenCoords(state,x,y){var t=transform(state.canvas);return{x:x*t.k+t.x,y:y*t.k+t.y}},screen2GraphCoords:function screen2GraphCoords(state,x,y){var t=transform(state.canvas);return{x:(x-t.x)/t.k,y:(y-t.y)/t.k}},centerAt:function centerAt(state,x,y,transitionDuration){if(!state.canvas)return null;if(void 0!==x||void 0!==y){var finalPos=Object.assign({},void 0!==x?{x}:{},void 0!==y?{y}:{});return transitionDuration?state.tweenGroup.add(new Tween(getCenter()).to(finalPos,transitionDuration).easing(Easing.Quadratic.Out).onUpdate(setCenter).start()):setCenter(finalPos),this}return getCenter();function getCenter(){var t=transform(state.canvas);return{x:(state.width/2-t.x)/t.k,y:(state.height/2-t.y)/t.k}}function setCenter(_ref5){var x=_ref5.x,y=_ref5.y;state.zoom.translateTo(state.zoom.__baseElem,void 0===x?getCenter().x:x,void 0===y?getCenter().y:y),state.needsRedraw=!0}},zoom:function zoom(state,k,transitionDuration){return state.canvas?void 0!==k?(transitionDuration?state.tweenGroup.add(new Tween({k:getZoom()}).to({k},transitionDuration).easing(Easing.Quadratic.Out).onUpdate((function(_ref6){return setZoom(_ref6.k)})).start()):setZoom(k),this):getZoom():null;function getZoom(){return transform(state.canvas).k}function setZoom(k){state.zoom.scaleTo(state.zoom.__baseElem,k),state.needsRedraw=!0}},zoomToFit:function zoomToFit(state){for(var transitionDuration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,padding=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,_len=arguments.length,bboxArgs=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)bboxArgs[_key-3]=arguments[_key];var bbox=this.getGraphBbox.apply(this,bboxArgs);if(bbox){var center={x:(bbox.x[0]+bbox.x[1])/2,y:(bbox.y[0]+bbox.y[1])/2},zoomK=Math.max(1e-12,Math.min(1e12,(state.width-2*padding)/(bbox.x[1]-bbox.x[0]),(state.height-2*padding)/(bbox.y[1]-bbox.y[0])));this.centerAt(center.x,center.y,transitionDuration),this.zoom(zoomK,transitionDuration)}return this},getGraphBbox:function getGraphBbox(state){var nodeFilter=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},getVal=accessor_fn_index(state.nodeVal),getR=function getR(node){return Math.sqrt(Math.max(0,getVal(node)||1))*state.nodeRelSize},nodesPos=state.graphData.nodes.filter(nodeFilter).map((function(node){return{x:node.x,y:node.y,r:getR(node)}}));return nodesPos.length?{x:[min(nodesPos,(function(node){return node.x-node.r})),max(nodesPos,(function(node){return node.x+node.r}))],y:[min(nodesPos,(function(node){return node.y-node.r})),max(nodesPos,(function(node){return node.y+node.r}))]}:null},pauseAnimation:function pauseAnimation(state){return state.animationFrameRequestId&&(cancelAnimationFrame(state.animationFrameRequestId),state.animationFrameRequestId=null),this},resumeAnimation:function resumeAnimation(state){return state.animationFrameRequestId||this._animationCycle(),this},_destructor:function _destructor(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},linkedMethods),stateInit:function stateInit(){return{lastSetZoom:1,zoom:zoom(),forceGraph:new CanvasForceGraph,shadowGraph:(new CanvasForceGraph).cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new _default,tweenGroup:new Group}},init:function init(domNode,state){var _this=this;domNode.innerHTML="";var container=document.createElement("div");container.classList.add("force-graph-container"),container.style.position="relative",domNode.appendChild(container),state.canvas=document.createElement("canvas"),state.backgroundColor&&(state.canvas.style.background=state.backgroundColor),container.appendChild(state.canvas),state.shadowCanvas=document.createElement("canvas");var ctx=state.canvas.getContext("2d"),shadowCtx=state.shadowCanvas.getContext("2d",{willReadFrequently:!0}),pointerPos={x:-1e12,y:-1e12},getObjUnderPointer=function getObjUnderPointer(){var obj=null,pxScale=window.devicePixelRatio,px=pointerPos.x>0&&pointerPos.y>0?shadowCtx.getImageData(pointerPos.x*pxScale,pointerPos.y*pxScale,1,1):null;return px&&(obj=state.colorTracker.lookup(px.data)),obj};src_select(state.canvas).call(function drag(){var mousedownx,mousedowny,mousemoving,touchending,filter=drag_defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=drag_defaultTouchable,gestures={},listeners=src_dispatch("start","drag","end"),active=0,clickDistance2=0;function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved,nonpassive).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(event,d){if(!touchending&&filter.call(this,event,d)){var gesture=beforestart(this,container.call(this,event,d),event,d,"mouse");gesture&&(src_select(event.view).on("mousemove.drag",mousemoved,nonpassivecapture).on("mouseup.drag",mouseupped,nonpassivecapture),nodrag(event.view),nopropagation(event),mousemoving=!1,mousedownx=event.clientX,mousedowny=event.clientY,gesture("start",event))}}function mousemoved(event){if(noevent(event),!mousemoving){var dx=event.clientX-mousedownx,dy=event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag",event)}function mouseupped(event){src_select(event.view).on("mousemove.drag mouseup.drag",null),yesdrag(event.view,mousemoving),noevent(event),gestures.mouse("end",event)}function touchstarted(event,d){if(filter.call(this,event,d)){var i,gesture,touches=event.changedTouches,c=container.call(this,event,d),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(this,c,event,d,touches[i].identifier,touches[i]))&&(nopropagation(event),gesture("start",event,touches[i]))}}function touchmoved(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(event),gesture("drag",event,touches[i]))}function touchended(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout((function(){touchending=null}),500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(event),gesture("end",event,touches[i]))}function beforestart(that,container,event,d,identifier,touch){var dx,dy,s,dispatch=listeners.copy(),p=pointer(touch||event,container);if(null!=(s=subject.call(that,new DragEvent("beforestart",{sourceEvent:event,target:drag,identifier,active,x:p[0],y:p[1],dx:0,dy:0,dispatch}),d)))return dx=s.x-p[0]||0,dy=s.y-p[1]||0,function gesture(type,event,touch){var n,p0=p;switch(type){case"start":gestures[identifier]=gesture,n=active++;break;case"end":delete gestures[identifier],--active;case"drag":p=pointer(touch||event,container),n=active}dispatch.call(type,that,new DragEvent(type,{sourceEvent:event,subject:s,target:drag,identifier,active:n,x:p[0]+dx,y:p[1]+dy,dx:p[0]-p0[0],dy:p[1]-p0[1],dispatch}),d)}}return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_drag_src_constant(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:d3_drag_src_constant(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:d3_drag_src_constant(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_drag_src_constant(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag}().subject((function(){if(!state.enableNodeDrag)return null;var obj=getObjUnderPointer();return obj&&"Node"===obj.type?obj.d:null})).on("start",(function(ev){var obj=ev.subject;obj.__initialDragPos={x:obj.x,y:obj.y,fx:obj.fx,fy:obj.fy},ev.active||(obj.fx=obj.x,obj.fy=obj.y),state.canvas.classList.add("grabbable")})).on("drag",(function(ev){var obj=ev.subject,initPos=obj.__initialDragPos,dragPos=ev,k=transform(state.canvas).k,translate={x:initPos.x+(dragPos.x-initPos.x)/k-obj.x,y:initPos.y+(dragPos.y-initPos.y)/k-obj.y};["x","y"].forEach((function(c){return obj["f".concat(c)]=obj[c]=initPos[c]+(dragPos[c]-initPos[c])/k})),!obj.__dragged&&5>=Math.sqrt(function sum(values,valueof){let sum=0;if(void 0===valueof)for(let value of values)(value=+value)&&(sum+=value);else{let index=-1;for(let value of values)(value=+valueof(value,++index,values))&&(sum+=value)}return sum}(["x","y"].map((function(k){return Math.pow(ev[k]-initPos[k],2)}))))||(state.forceGraph.d3AlphaTarget(.3).resetCountdown(),state.isPointerDragging=!0,obj.__dragged=!0,state.onNodeDrag(obj,translate))})).on("end",(function(ev){var obj=ev.subject,initPos=obj.__initialDragPos,translate={x:obj.x-initPos.x,y:obj.y-initPos.y};void 0===initPos.fx&&(obj.fx=void 0),void 0===initPos.fy&&(obj.fy=void 0),delete obj.__initialDragPos,state.forceGraph.d3AlphaTarget()&&state.forceGraph.d3AlphaTarget(0).resetCountdown(),state.canvas.classList.remove("grabbable"),state.isPointerDragging=!1,obj.__dragged&&(delete obj.__dragged,state.onNodeDragEnd(obj,translate))}))),state.zoom(state.zoom.__baseElem=src_select(state.canvas)),state.zoom.__baseElem.on("dblclick.zoom",null),state.zoom.filter((function(ev){return!ev.button&&state.enableZoomPanInteraction&&("wheel"!==ev.type||accessor_fn_index(state.enableZoomInteraction)(ev))&&("wheel"===ev.type||accessor_fn_index(state.enablePanInteraction)(ev))})).on("zoom",(function(ev){var t=ev.transform;[ctx,shadowCtx].forEach((function(c){resetTransform(c),c.translate(t.x,t.y),c.scale(t.k,t.k)})),state.isPointerDragging=!0,state.onZoom&&state.onZoom(force_graph_objectSpread2(force_graph_objectSpread2({},t),_this.centerAt())),state.needsRedraw=!0})).on("end",(function(ev){state.isPointerDragging=!1,state.onZoomEnd&&state.onZoomEnd(force_graph_objectSpread2(force_graph_objectSpread2({},ev.transform),_this.centerAt()))})),adjustCanvasSize(state),state.forceGraph.onNeedsRedraw((function(){return state.needsRedraw=!0})).onFinishUpdate((function(){transform(state.canvas).k===state.lastSetZoom&&state.graphData.nodes.length&&(state.zoom.scaleTo(state.zoom.__baseElem,state.lastSetZoom=4/Math.cbrt(state.graphData.nodes.length)),state.needsRedraw=!0)})),state.tooltip=new float_tooltip_index(container),["pointermove","pointerdown"].forEach((function(evType){return container.addEventListener(evType,(function(ev){"pointerdown"===evType&&(state.isPointerPressed=!0,state.pointerDownEvent=ev),!state.isPointerDragging&&"pointermove"===ev.type&&state.onBackgroundClick&&(ev.pressure>0||state.isPointerPressed)&&("mouse"===ev.pointerType||void 0===ev.movementX||[ev.movementX,ev.movementY].some((function(m){return Math.abs(m)>1})))&&(state.isPointerDragging=!0);var offset=function getOffset(el){var rect=el.getBoundingClientRect(),scrollLeft=window.pageXOffset||document.documentElement.scrollLeft,scrollTop=window.pageYOffset||document.documentElement.scrollTop;return{top:rect.top+scrollTop,left:rect.left+scrollLeft}}(container);pointerPos.x=ev.pageX-offset.left,pointerPos.y=ev.pageY-offset.top}),{passive:!0})})),container.addEventListener("pointerup",(function(ev){if(state.isPointerPressed)if(state.isPointerPressed=!1,state.isPointerDragging)state.isPointerDragging=!1;else{var cbEvents=[ev,state.pointerDownEvent];requestAnimationFrame((function(){if(0===ev.button)if(state.hoverObj){var fn=state["on".concat(state.hoverObj.type,"Click")];fn&&fn.apply(void 0,[state.hoverObj.d].concat(cbEvents))}else state.onBackgroundClick&&state.onBackgroundClick.apply(state,cbEvents);if(2===ev.button)if(state.hoverObj){var _fn=state["on".concat(state.hoverObj.type,"RightClick")];_fn&&_fn.apply(void 0,[state.hoverObj.d].concat(cbEvents))}else state.onBackgroundRightClick&&state.onBackgroundRightClick.apply(state,cbEvents)}))}}),{passive:!0}),container.addEventListener("contextmenu",(function(ev){return!(state.onBackgroundRightClick||state.onNodeRightClick||state.onLinkRightClick)||(ev.preventDefault(),!1)})),state.forceGraph(ctx),state.shadowGraph(shadowCtx);var refreshShadowCanvas=lodash_es_throttle((function(){clearCanvas(shadowCtx,state.width,state.height),state.shadowGraph.linkWidth((function(l){return accessor_fn_index(state.linkWidth)(l)+state.linkHoverPrecision}));var t=transform(state.canvas);state.shadowGraph.globalScale(t.k).tickFrame()}),800);state.flushShadowCanvas=refreshShadowCanvas.flush,(this._animationCycle=function animate(){var doRedraw=!state.autoPauseRedraw||!!state.needsRedraw||state.forceGraph.isEngineRunning()||state.graphData.links.some((function(d){return d.__photons&&d.__photons.length}));if(state.needsRedraw=!1,state.enablePointerInteraction){var obj=state.isPointerDragging?null:getObjUnderPointer();if(obj!==state.hoverObj){var prevObj=state.hoverObj,prevObjType=prevObj?prevObj.type:null,objType=obj?obj.type:null;if(prevObjType&&prevObjType!==objType){var fn=state["on".concat(prevObjType,"Hover")];fn&&fn(null,prevObj.d)}if(objType){var _fn2=state["on".concat(objType,"Hover")];_fn2&&_fn2(obj.d,prevObjType===objType?prevObj.d:null)}state.tooltip.content(obj&&accessor_fn_index(state["".concat(obj.type.toLowerCase(),"Label")])(obj.d)||null),state.canvas.classList[obj&&state["on".concat(objType,"Click")]||!obj&&state.onBackgroundClick?"add":"remove"]("clickable"),state.hoverObj=obj}doRedraw&&refreshShadowCanvas()}if(doRedraw){clearCanvas(ctx,state.width,state.height);var globalScale=transform(state.canvas).k;state.onRenderFramePre&&state.onRenderFramePre(ctx,globalScale),state.forceGraph.globalScale(globalScale).tickFrame(),state.onRenderFramePost&&state.onRenderFramePost(ctx,globalScale)}state.tweenGroup.update(),state.animationFrameRequestId=requestAnimationFrame(animate)})()},update:function updateFn(state){}}),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types);const commonPropTypes={width:prop_types_default().number,height:prop_types_default().number,graphData:prop_types_default().shape({nodes:prop_types_default().arrayOf(prop_types_default().object).isRequired,links:prop_types_default().arrayOf(prop_types_default().object).isRequired}),backgroundColor:prop_types_default().string,nodeRelSize:prop_types_default().number,nodeId:prop_types_default().string,nodeLabel:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),nodeVal:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),nodeVisibility:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().string,prop_types_default().func]),nodeColor:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),nodeAutoColorBy:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),onNodeHover:prop_types_default().func,onNodeClick:prop_types_default().func,linkSource:prop_types_default().string,linkTarget:prop_types_default().string,linkLabel:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkVisibility:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().string,prop_types_default().func]),linkColor:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkAutoColorBy:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkWidth:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkCurvature:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalArrowLength:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalArrowColor:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkDirectionalArrowRelPos:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalParticles:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalParticleSpeed:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalParticleOffset:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalParticleWidth:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkDirectionalParticleColor:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),onLinkHover:prop_types_default().func,onLinkClick:prop_types_default().func,dagMode:prop_types_default().oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:prop_types_default().number,dagNodeFilter:prop_types_default().func,onDagError:prop_types_default().func,d3AlphaMin:prop_types_default().number,d3AlphaDecay:prop_types_default().number,d3VelocityDecay:prop_types_default().number,warmupTicks:prop_types_default().number,cooldownTicks:prop_types_default().number,cooldownTime:prop_types_default().number,onEngineTick:prop_types_default().func,onEngineStop:prop_types_default().func,getGraphBbox:prop_types_default().func},pointerBasedPropTypes={zoomToFit:prop_types_default().func,onNodeRightClick:prop_types_default().func,onNodeDrag:prop_types_default().func,onNodeDragEnd:prop_types_default().func,onLinkRightClick:prop_types_default().func,linkHoverPrecision:prop_types_default().number,onBackgroundClick:prop_types_default().func,onBackgroundRightClick:prop_types_default().func,enablePointerInteraction:prop_types_default().bool,enableNodeDrag:prop_types_default().bool},threeBasedPropTypes={showNavInfo:prop_types_default().bool,nodeOpacity:prop_types_default().number,nodeResolution:prop_types_default().number,nodeThreeObject:prop_types_default().oneOfType([prop_types_default().object,prop_types_default().string,prop_types_default().func]),nodeThreeObjectExtend:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().string,prop_types_default().func]),nodePositionUpdate:prop_types_default().func,linkOpacity:prop_types_default().number,linkResolution:prop_types_default().number,linkCurveRotation:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string,prop_types_default().func]),linkMaterial:prop_types_default().oneOfType([prop_types_default().object,prop_types_default().string,prop_types_default().func]),linkThreeObject:prop_types_default().oneOfType([prop_types_default().object,prop_types_default().string,prop_types_default().func]),linkThreeObjectExtend:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().string,prop_types_default().func]),linkPositionUpdate:prop_types_default().func,linkDirectionalArrowResolution:prop_types_default().number,linkDirectionalParticleResolution:prop_types_default().number,linkDirectionalParticleThreeObject:prop_types_default().oneOfType([prop_types_default().object,prop_types_default().string,prop_types_default().func]),forceEngine:prop_types_default().oneOf(["d3","ngraph"]),ngraphPhysics:prop_types_default().object,numDimensions:prop_types_default().oneOf([1,2,3])},ForceGraph2DPropTypes=Object.assign({},commonPropTypes,pointerBasedPropTypes,{linkLineDash:prop_types_default().oneOfType([prop_types_default().arrayOf(prop_types_default().number),prop_types_default().string,prop_types_default().func]),nodeCanvasObjectMode:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),nodeCanvasObject:prop_types_default().func,nodePointerAreaPaint:prop_types_default().func,linkCanvasObjectMode:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkCanvasObject:prop_types_default().func,linkPointerAreaPaint:prop_types_default().func,linkDirectionalParticleCanvasObject:prop_types_default().func,autoPauseRedraw:prop_types_default().bool,minZoom:prop_types_default().number,maxZoom:prop_types_default().number,enableZoomInteraction:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().func]),enablePanInteraction:prop_types_default().oneOfType([prop_types_default().bool,prop_types_default().func]),onZoom:prop_types_default().func,onZoomEnd:prop_types_default().func,onRenderFramePre:prop_types_default().func,onRenderFramePost:prop_types_default().func});Object.assign({},commonPropTypes,pointerBasedPropTypes,threeBasedPropTypes,{enableNavigationControls:prop_types_default().bool,controlType:prop_types_default().oneOf(["trackball","orbit","fly"]),rendererConfig:prop_types_default().object,extraRenderers:prop_types_default().arrayOf(prop_types_default().shape({render:prop_types_default().func.isRequired}))}),Object.assign({},commonPropTypes,threeBasedPropTypes,{nodeDesc:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func]),linkDesc:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().func])}),Object.assign({},commonPropTypes,threeBasedPropTypes,{markerAttrs:prop_types_default().object,yOffset:prop_types_default().number,glScale:prop_types_default().number});const ForceGraph2D=function index(kapsuleComponent){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$wrapperElementTy=_ref.wrapperElementType,wrapperElementType=void 0===_ref$wrapperElementTy?"div":_ref$wrapperElementTy,_ref$nodeMapper=_ref.nodeMapper,nodeMapper=void 0===_ref$nodeMapper?function(node){return node}:_ref$nodeMapper,_ref$methodNames=_ref.methodNames,methodNames=void 0===_ref$methodNames?[]:_ref$methodNames,_ref$initPropNames=_ref.initPropNames,initPropNames=void 0===_ref$initPropNames?[]:_ref$initPropNames;return(0,react.forwardRef)((function(props,ref){var domEl=(0,react.useRef)(),comp=(0,react.useMemo)((function(){var configOptions=Object.fromEntries(initPropNames.filter((function(p){return props.hasOwnProperty(p)})).map((function(prop){return[prop,props[prop]]})));return kapsuleComponent(configOptions)}),[]);useEffectOnce((function(){comp(nodeMapper(domEl.current))}),react.useLayoutEffect),useEffectOnce((function(){return comp._destructor instanceof Function?comp._destructor:void 0}));var _call=(0,react.useCallback)((function(method){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return comp[method]instanceof Function?comp[method].apply(comp,args):void 0}),[comp]),prevPropsRef=(0,react.useRef)({});return Object.keys(function omit(obj,keys){var keySet=new Set(keys);return Object.assign.apply(Object,[{}].concat(_toConsumableArray(Object.entries(obj).filter((function(_ref2){var key=_slicedToArray(_ref2,1)[0];return!keySet.has(key)})).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2);return _defineProperty({},_ref5[0],_ref5[1])})))))}(props,[].concat(react_kapsule_toConsumableArray(methodNames),react_kapsule_toConsumableArray(initPropNames)))).filter((function(p){return prevPropsRef.current[p]!==props[p]})).forEach((function(p){return _call(p,props[p])})),prevPropsRef.current=props,(0,react.useImperativeHandle)(ref,(function(){return Object.fromEntries(methodNames.map((function(method){return[method,function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return _call.apply(void 0,[method].concat(args))}]})))}),[_call]),react.createElement(wrapperElementType,{ref:domEl})}))}(forceGraph,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});ForceGraph2D.displayName="ForceGraph2D",ForceGraph2D.propTypes=ForceGraph2DPropTypes}}]);